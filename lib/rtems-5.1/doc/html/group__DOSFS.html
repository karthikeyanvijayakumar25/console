<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RTEMS: FAT Filesystem Support</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rtemslogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RTEMS
   &#160;<span id="projectnumber">5.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">FAT Filesystem Support<div class="ingroups"><a class="el" href="group__LibIO.html">IO Library</a> &raquo; <a class="el" href="group__FileSystemTypesAndMount.html">File System Types and Mount</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>FAT file system configuration support, format and mount options.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:dosfs_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dosfs_8h.html">dosfs.h</a></td></tr>
<tr class="memdesc:dosfs_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Application Interface to FAT Filesystem. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:msdos__conv__default_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="msdos__conv__default_8c.html">msdos_conv_default.c</a></td></tr>
<tr class="memdesc:msdos__conv__default_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default Converter. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:msdos__conv__utf8_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="msdos__conv__utf8_8c.html">msdos_conv_utf8.c</a></td></tr>
<tr class="memdesc:msdos__conv__utf8_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">UTF-8 Converter. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtems__dosfs__mount__options.html">rtems_dosfs_mount_options</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">FAT filesystem mount options.  <a href="structrtems__dosfs__mount__options.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmsdos__format__request__param__t.html">msdos_format_request_param_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">FAT file system format request parameters.  <a href="structmsdos__format__request__param__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaf5f22bc1798c9fd6a8f577ebd38aaa42"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DOSFS.html#gaf5f22bc1798c9fd6a8f577ebd38aaa42">RTEMS_DOSFS_SEMAPHORES_PER_INSTANCE</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:gaf5f22bc1798c9fd6a8f577ebd38aaa42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Semaphore count per FAT filesystem instance.  <a href="#gaf5f22bc1798c9fd6a8f577ebd38aaa42">More...</a><br /></td></tr>
<tr class="separator:gaf5f22bc1798c9fd6a8f577ebd38aaa42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadbca2d92c455a1d790c18c3438b94b53"><td class="memItemLeft" align="right" valign="top"><a id="gadbca2d92c455a1d790c18c3438b94b53"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MSDOS_FMT_INFO_LEVEL_NONE</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:gadbca2d92c455a1d790c18c3438b94b53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6934cdd3173752954ac8cc822190acf1"><td class="memItemLeft" align="right" valign="top"><a id="ga6934cdd3173752954ac8cc822190acf1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MSDOS_FMT_INFO_LEVEL_INFO</b>&#160;&#160;&#160;(1)</td></tr>
<tr class="separator:ga6934cdd3173752954ac8cc822190acf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad91890710b15a367a041f4d9e1efc9b2"><td class="memItemLeft" align="right" valign="top"><a id="gad91890710b15a367a041f4d9e1efc9b2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MSDOS_FMT_INFO_LEVEL_DETAIL</b>&#160;&#160;&#160;(2)</td></tr>
<tr class="separator:gad91890710b15a367a041f4d9e1efc9b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga819bc56f5cd94de8ae14ae39eeb302e2"><td class="memItemLeft" align="right" valign="top"><a id="ga819bc56f5cd94de8ae14ae39eeb302e2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MSDOS_FMT_INFO_LEVEL_DEBUG</b>&#160;&#160;&#160;(3)</td></tr>
<tr class="separator:ga819bc56f5cd94de8ae14ae39eeb302e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9dc28ad698d4946c7bf691fa0b0a6c78"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrtems__dosfs__convert__control.html">rtems_dosfs_convert_control</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DOSFS.html#ga9dc28ad698d4946c7bf691fa0b0a6c78">rtems_dosfs_create_default_converter</a> (void)</td></tr>
<tr class="memdesc:ga9dc28ad698d4946c7bf691fa0b0a6c78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates and initializes a default converter.  <a href="#ga9dc28ad698d4946c7bf691fa0b0a6c78">More...</a><br /></td></tr>
<tr class="separator:ga9dc28ad698d4946c7bf691fa0b0a6c78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47cec61b81f7868a5b821709246a8509"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrtems__dosfs__convert__control.html">rtems_dosfs_convert_control</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DOSFS.html#ga47cec61b81f7868a5b821709246a8509">rtems_dosfs_create_utf8_converter</a> (const char *codepage)</td></tr>
<tr class="memdesc:ga47cec61b81f7868a5b821709246a8509"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates and initializes a UTF-8 converter.  <a href="#ga47cec61b81f7868a5b821709246a8509">More...</a><br /></td></tr>
<tr class="separator:ga47cec61b81f7868a5b821709246a8509"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89cdc98023478833b6291f2e3cea56f2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DOSFS.html#ga89cdc98023478833b6291f2e3cea56f2">msdos_format</a> (const char *devname, const <a class="el" href="structmsdos__format__request__param__t.html">msdos_format_request_param_t</a> *rqdata)</td></tr>
<tr class="memdesc:ga89cdc98023478833b6291f2e3cea56f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Formats a block device with a FAT file system.  <a href="#ga89cdc98023478833b6291f2e3cea56f2">More...</a><br /></td></tr>
<tr class="separator:ga89cdc98023478833b6291f2e3cea56f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>FAT file system configuration support, format and mount options. </p>
<p>A block device can be formatted with a FAT file system with the <a class="el" href="group__DOSFS.html#ga89cdc98023478833b6291f2e3cea56f2" title="Formats a block device with a FAT file system.">msdos_format()</a> function.</p>
<p>The FAT file system mount operation can be controlled with FAT file system specific mount options, see <a class="el" href="structrtems__dosfs__mount__options.html">rtems_dosfs_mount_options</a>. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gaf5f22bc1798c9fd6a8f577ebd38aaa42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf5f22bc1798c9fd6a8f577ebd38aaa42">&#9670;&nbsp;</a></span>RTEMS_DOSFS_SEMAPHORES_PER_INSTANCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RTEMS_DOSFS_SEMAPHORES_PER_INSTANCE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Semaphore count per FAT filesystem instance. </p>
<p>This can be used for system configuration via &lt;<a class="el" href="confdefs_8h.html" title="Evaluate Configuration Options.">rtems/confdefs.h</a>&gt;. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga89cdc98023478833b6291f2e3cea56f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89cdc98023478833b6291f2e3cea56f2">&#9670;&nbsp;</a></span>msdos_format()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int msdos_format </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>devname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmsdos__format__request__param__t.html">msdos_format_request_param_t</a> *&#160;</td>
          <td class="paramname"><em>rqdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Formats a block device with a FAT file system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">devname</td><td>The block device path. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rqdata</td><td>The FAT file system format request data. Use NULL for default parameters.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Successful operation. </td></tr>
    <tr><td class="paramname">-1</td><td>An error occurred. The <code>errno</code> indicates the error. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9dc28ad698d4946c7bf691fa0b0a6c78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9dc28ad698d4946c7bf691fa0b0a6c78">&#9670;&nbsp;</a></span>rtems_dosfs_create_default_converter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrtems__dosfs__convert__control.html">rtems_dosfs_convert_control</a>* rtems_dosfs_create_default_converter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates and initializes a default converter. </p>
<p>This default converter will accept only POSIX file names with pure ASCII characters. This largely corresponds to the file name handling before the optional UTF-8 support was added to the RTEMS implementation of the FAT file system. This handling is mostly backwards compatible to the previous RTEMS implementation of the FAT file system.</p>
<p>For backwards compatibility and the previous RTEMS implementation of the FAT file system please see also <a class="el" href="structrtems__dosfs__mount__options.html">rtems_dosfs_mount_options</a> and <a class="el" href="group__FileSystemTypesAndMount.html#gaf3c1bed49bb0f3dec88d330b4f88d48b" title="Mounts a file system instance at the specified target path.">mount()</a>.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Something failed. </td></tr>
    <tr><td class="paramname">other</td><td>Pointer to initialized converter. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga47cec61b81f7868a5b821709246a8509"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga47cec61b81f7868a5b821709246a8509">&#9670;&nbsp;</a></span>rtems_dosfs_create_utf8_converter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrtems__dosfs__convert__control.html">rtems_dosfs_convert_control</a>* rtems_dosfs_create_utf8_converter </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>codepage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates and initializes a UTF-8 converter. </p>
<p>This converter will assume that all file names passed to POSIX file handling methods are UTF-8 strings and will convert them to the selected code page for short file names and to UTF-16 for long file names. This conversion will be done during reading and writing. These conversions correspond to the specification of the FAT file system. This handling is mostly backwards compatible to the previous RTEMS implementation of the FAT file system.</p>
<p>For backwards compatibility and the previous RTEMS implementation of the FAT file system please see also <a class="el" href="structrtems__dosfs__mount__options.html">rtems_dosfs_mount_options</a> and <a class="el" href="group__FileSystemTypesAndMount.html#gaf3c1bed49bb0f3dec88d330b4f88d48b" title="Mounts a file system instance at the specified target path.">mount()</a>.</p>
<p>One possible issue with this converter is: When reading file names which have been created with other implementations of the FAT file system, it can happen that during the conversion to UTF-8 a long file name becomes longer and exceeds the 255 bytes limit. In such a case only the short file name will get read.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">codepage</td><td>The iconv() identification string for the used code page.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Something failed. </td></tr>
    <tr><td class="paramname">other</td><td>Pointer to initialized converter. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
