<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RTEMS: bsps/arm/tms570/start/init_system.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rtemslogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RTEMS
   &#160;<span id="projectnumber">5.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_49b8d5997469a34e9a523535602b7e1a.html">bsps</a></li><li class="navelem"><a class="el" href="dir_5f7c3d4818c142e5ac9b73b670fac05b.html">arm</a></li><li class="navelem"><a class="el" href="dir_4e70354d9ffc2d07a95c0b4d9b97e498.html">tms570</a></li><li class="navelem"><a class="el" href="dir_e8c6b8e2752a1c9198adab6b087d7e45.html">start</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">init_system.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;bsp/tms570.h&gt;</code><br />
<code>#include &lt;<a class="el" href="tms570-pinmux_8h_source.html">bsp/tms570-pinmux.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="tms570__selftest_8h_source.html">bsp/tms570_selftest.h</a>&gt;</code><br />
<code>#include &lt;bsp/tms570_hwinit.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ac81098bb0fe7b47840aa83f144348ce2"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init__system_8c.html#ac81098bb0fe7b47840aa83f144348ce2">tms570_flash_power_modes</a> { <a class="el" href="init__system_8c.html#ac81098bb0fe7b47840aa83f144348ce2aa191dae1652d61f82d9576b9f64c978f">TMS570_FLASH_SYS_SLEEP</a> = 0U, 
<a class="el" href="init__system_8c.html#ac81098bb0fe7b47840aa83f144348ce2abd977a52a5d1ef87b38649bc5b39f1dc">TMS570_FLASH_SYS_STANDBY</a> = 1U, 
<a class="el" href="init__system_8c.html#ac81098bb0fe7b47840aa83f144348ce2a4bc6e80ba03272066b21b8f6b625501b">TMS570_FLASH_SYS_ACTIVE</a> = 3U
 }</td></tr>
<tr class="separator:ac81098bb0fe7b47840aa83f144348ce2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b87d3b1d1ea4ef81709cc6491cb6608"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init__system_8c.html#a4b87d3b1d1ea4ef81709cc6491cb6608">tms570_system_clock_source</a> { <br />
&#160;&#160;<a class="el" href="init__system_8c.html#a4b87d3b1d1ea4ef81709cc6491cb6608a69ae48500ceffad67372d4c485b9e03d">TMS570_SYS_CLK_SRC_OSC</a> = 0U, 
<a class="el" href="init__system_8c.html#a4b87d3b1d1ea4ef81709cc6491cb6608ad324daa9da62c925571e6f614dd035c5">TMS570_SYS_CLK_SRC_PLL1</a> = 1U, 
<a class="el" href="init__system_8c.html#a4b87d3b1d1ea4ef81709cc6491cb6608a97b2c9e074e7098593896dc10db78b44">TMS570_SYS_CLK_SRC_EXTERNAL1</a> = 3U, 
<a class="el" href="init__system_8c.html#a4b87d3b1d1ea4ef81709cc6491cb6608aab4fab1a8500c5d03793220889c67519">TMS570_SYS_CLK_SRC_LPO_LOW</a> = 4U, 
<br />
&#160;&#160;<a class="el" href="init__system_8c.html#a4b87d3b1d1ea4ef81709cc6491cb6608a02114fb4240c1ea258c1beceda9d146c">TMS570_SYS_CLK_SRC_LPO_HIGH</a> = 5U, 
<a class="el" href="init__system_8c.html#a4b87d3b1d1ea4ef81709cc6491cb6608a51d31ad09a40e2a63773eca0bf8f0698">TMS570_SYS_CLK_SRC_PLL2</a> = 6U, 
<a class="el" href="init__system_8c.html#a4b87d3b1d1ea4ef81709cc6491cb6608a1145d14618d09ccf404cd6a7be24b4e0">TMS570_SYS_CLK_SRC_EXTERNAL2</a> = 7U, 
<a class="el" href="init__system_8c.html#a4b87d3b1d1ea4ef81709cc6491cb6608ac1ef0f123ba05b55629b7d1e1728018d">TMS570_SYS_CLK_SRC_VCLK</a> = 9U
<br />
 }</td></tr>
<tr class="separator:a4b87d3b1d1ea4ef81709cc6491cb6608"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a43137f0b9b1e10251be70ee40935709a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init__system_8c.html#a43137f0b9b1e10251be70ee40935709a">tms570_pll_init</a> (void)</td></tr>
<tr class="memdesc:a43137f0b9b1e10251be70ee40935709a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup all system PLLs (HCG:setupPLL)  <a href="#a43137f0b9b1e10251be70ee40935709a">More...</a><br /></td></tr>
<tr class="separator:a43137f0b9b1e10251be70ee40935709a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a788b6e4333764ce64557748a795fcaef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init__system_8c.html#a788b6e4333764ce64557748a795fcaef">tms570_trim_lpo_init</a> (void)</td></tr>
<tr class="memdesc:a788b6e4333764ce64557748a795fcaef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjust Low-Frequency (LPO) oscilator (HCG:trimLPO)  <a href="#a788b6e4333764ce64557748a795fcaef">More...</a><br /></td></tr>
<tr class="separator:a788b6e4333764ce64557748a795fcaef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93991a2136c7abc0b1c6be56b46bd1dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init__system_8c.html#a93991a2136c7abc0b1c6be56b46bd1dd">tms570_flash_init</a> (void)</td></tr>
<tr class="memdesc:a93991a2136c7abc0b1c6be56b46bd1dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup Flash memory parameters and timing (HCG:setupFlash)  <a href="#a93991a2136c7abc0b1c6be56b46bd1dd">More...</a><br /></td></tr>
<tr class="separator:a93991a2136c7abc0b1c6be56b46bd1dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae309cda1599147b5dbdec6c4d19732b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init__system_8c.html#ae309cda1599147b5dbdec6c4d19732b6">tms570_periph_init</a> (void)</td></tr>
<tr class="memdesc:ae309cda1599147b5dbdec6c4d19732b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Power-up all peripherals and enable their clocks (HCG:periphInit)  <a href="#ae309cda1599147b5dbdec6c4d19732b6">More...</a><br /></td></tr>
<tr class="separator:ae309cda1599147b5dbdec6c4d19732b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6843c9d8e672b736a060ea5314bd2c91"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init__system_8c.html#a6843c9d8e672b736a060ea5314bd2c91">tms570_map_clock_init</a> (void)</td></tr>
<tr class="memdesc:a6843c9d8e672b736a060ea5314bd2c91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup chip clocks including to wait for PLLs locks (HCG:mapClocks)  <a href="#a6843c9d8e672b736a060ea5314bd2c91">More...</a><br /></td></tr>
<tr class="separator:a6843c9d8e672b736a060ea5314bd2c91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfc60d117ea095a205722a96aeaf3b65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init__system_8c.html#adfc60d117ea095a205722a96aeaf3b65">tms570_system_hw_init</a> (void)</td></tr>
<tr class="memdesc:adfc60d117ea095a205722a96aeaf3b65"><td class="mdescLeft">&#160;</td><td class="mdescRight">TMS570 system hardware initialization (HCG:systemInit)  <a href="#adfc60d117ea095a205722a96aeaf3b65">More...</a><br /></td></tr>
<tr class="separator:adfc60d117ea095a205722a96aeaf3b65"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>based on Ti HalCoGen generated file </p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ac81098bb0fe7b47840aa83f144348ce2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac81098bb0fe7b47840aa83f144348ce2">&#9670;&nbsp;</a></span>tms570_flash_power_modes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="init__system_8c.html#ac81098bb0fe7b47840aa83f144348ce2">tms570_flash_power_modes</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ac81098bb0fe7b47840aa83f144348ce2aa191dae1652d61f82d9576b9f64c978f"></a>TMS570_FLASH_SYS_SLEEP&#160;</td><td class="fielddoc"><p>Alias for flash bank power mode sleep </p>
</td></tr>
<tr><td class="fieldname"><a id="ac81098bb0fe7b47840aa83f144348ce2abd977a52a5d1ef87b38649bc5b39f1dc"></a>TMS570_FLASH_SYS_STANDBY&#160;</td><td class="fielddoc"><p>Alias for flash bank power mode standby </p>
</td></tr>
<tr><td class="fieldname"><a id="ac81098bb0fe7b47840aa83f144348ce2a4bc6e80ba03272066b21b8f6b625501b"></a>TMS570_FLASH_SYS_ACTIVE&#160;</td><td class="fielddoc"><p>Alias for flash bank power mode active </p>
</td></tr>
</table>

</div>
</div>
<a id="a4b87d3b1d1ea4ef81709cc6491cb6608"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b87d3b1d1ea4ef81709cc6491cb6608">&#9670;&nbsp;</a></span>tms570_system_clock_source</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="init__system_8c.html#a4b87d3b1d1ea4ef81709cc6491cb6608">tms570_system_clock_source</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a4b87d3b1d1ea4ef81709cc6491cb6608a69ae48500ceffad67372d4c485b9e03d"></a>TMS570_SYS_CLK_SRC_OSC&#160;</td><td class="fielddoc"><p>Alias for oscillator clock Source </p>
</td></tr>
<tr><td class="fieldname"><a id="a4b87d3b1d1ea4ef81709cc6491cb6608ad324daa9da62c925571e6f614dd035c5"></a>TMS570_SYS_CLK_SRC_PLL1&#160;</td><td class="fielddoc"><p>Alias for Pll1 clock Source </p>
</td></tr>
<tr><td class="fieldname"><a id="a4b87d3b1d1ea4ef81709cc6491cb6608a97b2c9e074e7098593896dc10db78b44"></a>TMS570_SYS_CLK_SRC_EXTERNAL1&#160;</td><td class="fielddoc"><p>Alias for external clock Source </p>
</td></tr>
<tr><td class="fieldname"><a id="a4b87d3b1d1ea4ef81709cc6491cb6608aab4fab1a8500c5d03793220889c67519"></a>TMS570_SYS_CLK_SRC_LPO_LOW&#160;</td><td class="fielddoc"><p>Alias for low power oscillator low clock Source </p>
</td></tr>
<tr><td class="fieldname"><a id="a4b87d3b1d1ea4ef81709cc6491cb6608a02114fb4240c1ea258c1beceda9d146c"></a>TMS570_SYS_CLK_SRC_LPO_HIGH&#160;</td><td class="fielddoc"><p>Alias for low power oscillator high clock Source </p>
</td></tr>
<tr><td class="fieldname"><a id="a4b87d3b1d1ea4ef81709cc6491cb6608a51d31ad09a40e2a63773eca0bf8f0698"></a>TMS570_SYS_CLK_SRC_PLL2&#160;</td><td class="fielddoc"><p>Alias for Pll2 clock Source </p>
</td></tr>
<tr><td class="fieldname"><a id="a4b87d3b1d1ea4ef81709cc6491cb6608a1145d14618d09ccf404cd6a7be24b4e0"></a>TMS570_SYS_CLK_SRC_EXTERNAL2&#160;</td><td class="fielddoc"><p>Alias for external 2 clock Source </p>
</td></tr>
<tr><td class="fieldname"><a id="a4b87d3b1d1ea4ef81709cc6491cb6608ac1ef0f123ba05b55629b7d1e1728018d"></a>TMS570_SYS_CLK_SRC_VCLK&#160;</td><td class="fielddoc"><p>Alias for synchronous VCLK1 clock Source </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a93991a2136c7abc0b1c6be56b46bd1dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93991a2136c7abc0b1c6be56b46bd1dd">&#9670;&nbsp;</a></span>tms570_flash_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tms570_flash_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup Flash memory parameters and timing (HCG:setupFlash) </p>
<ul>
<li>Setup flash read mode, address wait states and data wait states</li>
<li>Setup flash access wait states for bank 7</li>
<li>Disable write access to flash state machine registers</li>
<li>Setup flash bank power modes </li>
</ul>

</div>
</div>
<a id="a6843c9d8e672b736a060ea5314bd2c91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6843c9d8e672b736a060ea5314bd2c91">&#9670;&nbsp;</a></span>tms570_map_clock_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tms570_map_clock_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup chip clocks including to wait for PLLs locks (HCG:mapClocks) </p>
<p><b>Initialize</b> <b>Clock</b> <b>Tree:</b> </p>
<ul>
<li>Disable / Enable clock domain</li>
<li>Wait for until clocks are locked</li>
<li>Map device clock domains to desired sources and configure top-level dividers</li>
<li>All clock domains are working off the default clock sources until now</li>
<li>The below assignments can be easily modified using the HALCoGen GUI</li>
<li>Setup GCLK, HCLK and VCLK clock source for normal operation, power down mode and after wakeup</li>
<li>Setup synchronous peripheral clock dividers for VCLK1, VCLK2, VCLK3</li>
<li>Setup RTICLK1 and RTICLK2 clocks</li>
<li>Setup asynchronous peripheral clock sources for AVCLK1 and AVCLK2 </li>
</ul>

</div>
</div>
<a id="ae309cda1599147b5dbdec6c4d19732b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae309cda1599147b5dbdec6c4d19732b6">&#9670;&nbsp;</a></span>tms570_periph_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tms570_periph_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Power-up all peripherals and enable their clocks (HCG:periphInit) </p>
<ul>
<li>Disable Peripherals before peripheral powerup</li>
<li>Release peripherals from reset and enable clocks to all peripherals</li>
<li>Power-up all peripherals</li>
<li>Enable Peripherals </li>
</ul>

</div>
</div>
<a id="a43137f0b9b1e10251be70ee40935709a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43137f0b9b1e10251be70ee40935709a">&#9670;&nbsp;</a></span>tms570_pll_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tms570_pll_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup all system PLLs (HCG:setupPLL) </p>
<ul>
<li>Configure PLL control registers</li>
</ul>
<p><b>Initialize</b> <b>Pll1:</b> </p>
<p><b>Initialize</b> <b>Pll2:</b> </p>
<ul>
<li>Enable PLL(s) to start up or Lock </li>
</ul>

</div>
</div>
<a id="adfc60d117ea095a205722a96aeaf3b65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfc60d117ea095a205722a96aeaf3b65">&#9670;&nbsp;</a></span>tms570_system_hw_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tms570_system_hw_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>TMS570 system hardware initialization (HCG:systemInit) </p>
<ul>
<li>Set up flash address and data wait states based on the target CPU clock frequency The number of address and data wait states for the target CPU clock frequency are specified in the specific part's datasheet.</li>
<li>Configure the LPO such that HF LPO is as close to 10MHz as possible</li>
<li>Wait for PLLs to start up and map clock domains to desired clock sources</li>
<li>set ECLK pins functional mode</li>
<li>set ECLK pins default output value</li>
<li>set ECLK pins output direction</li>
<li>set ECLK pins open drain enable</li>
<li>set ECLK pins pullup/pulldown enable</li>
<li>set ECLK pins pullup/pulldown select</li>
<li>Setup ECLK </li>
</ul>

</div>
</div>
<a id="a788b6e4333764ce64557748a795fcaef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a788b6e4333764ce64557748a795fcaef">&#9670;&nbsp;</a></span>tms570_trim_lpo_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tms570_trim_lpo_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjust Low-Frequency (LPO) oscilator (HCG:trimLPO) </p>
<p><b>Initialize</b> Lpo:</p>
<p>Load TRIM values from OTP if present else load user defined values </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
