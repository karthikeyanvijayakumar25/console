<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RTEMS: cpukit/libdl/rtl-trampoline.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rtemslogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RTEMS
   &#160;<span id="projectnumber">5.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_cd198e36225ba3f41de97552050ac017.html">cpukit</a></li><li class="navelem"><a class="el" href="dir_18969d2c90e3ffddab35ecf776e9a0c5.html">libdl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">rtl-trampoline.h File Reference<div class="ingroups"><a class="el" href="group__RTEMSAPI.html">API</a> &raquo; <a class="el" href="group__rtems__rtl.html">RTEMS Runtime Link Editor</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>RTEMS Run-Time Linker Object File Trampoline Relocations Table.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="rtl-unresolved_8h_source.html">rtems/rtl/rtl-unresolved.h</a>&gt;</code><br />
</div>
<p><a href="rtl-trampoline_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a996f6ce5f419e92e3d4b00093da4320e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rtl-trampoline_8h.html#a996f6ce5f419e92e3d4b00093da4320e">rtems_rtl_trampoline_add</a> (<a class="el" href="structrtems__rtl__obj.html">rtems_rtl_obj</a> *obj, const uint16_t flags, const uint16_t sect, const <a class="el" href="rtl-unresolved_8h.html#a5ab1ca8c94e49686f84f5ccf0731f0e6">rtems_rtl_word</a> symvalue, const <a class="el" href="rtl-unresolved_8h.html#a5ab1ca8c94e49686f84f5ccf0731f0e6">rtems_rtl_word</a> *rel)</td></tr>
<tr class="separator:a996f6ce5f419e92e3d4b00093da4320e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a962fc939ba38c1794ff7acdb15cdfa16"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rtl-trampoline_8h.html#a962fc939ba38c1794ff7acdb15cdfa16">rtems_rtl_trampoline_remove</a> (<a class="el" href="structrtems__rtl__obj.html">rtems_rtl_obj</a> *obj)</td></tr>
<tr class="separator:a962fc939ba38c1794ff7acdb15cdfa16"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>RTEMS Run-Time Linker Object File Trampoline Relocations Table. </p>
<p>Cache relocation records that could result in a trampoline. The unresolved symbol table holds variable the symbol name (length string) and the object file's relocation records that reference the unresolved symbol. The trampoline cache is an extension to this table to reuse the code and memory and support trampolines.</p>
<p>Some architectures require trampolines or veneers to extend the range of some instructions. The compiler generates small optimized instructions assuming most destinations are within the range of the instruction. The instructions are smaller in size and can have a number of encodings with different ranges. If a relocation record points to a symbol that is out of range for the instruction a trampoline is used to extend the instruction's range. A trampoline is a small fragment of architecture specific instructions located within the range of the relocation record instruction that can reach the entire address range. The trampoline's execution is transparent to the execution of the object file.</p>
<p>An object file that needs a trampoline has a table allocated close to the text section. It has to be close to ensure the largest possible object file can be spported. The number of slots in a table depends on:</p>
<h1>Location of the code</h1>
<h1>The type of relocation records in the object file</h1>
<h1>The instruction encoding the relocation record points too</h1>
<h1>The landing address of the instruction</h1>
<p>The allocation of the text segment and the trampoline table have to happen with the allocator lock being locked and held to make sure no other allocations happen inbetween the text section allocation and the trampoline table. Holding an allocator lock limits what the link editor can do when when the default heap allocator is being used. If calls any operating system services including the file system use the same allocator a deadlock will occur. This creates a conflict between performing the allocations together and reading the instructions while holding the allocator lock.</p>
<p>The trampoline cache holds the parsed relocation records that could result in a trampoline. These records can be exaimined after the allocation of the text segment to determine how many relocation record target's are out of range. The minimum range for a specific type of relocation record has to be used as the instructions cannot be loaded. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a996f6ce5f419e92e3d4b00093da4320e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a996f6ce5f419e92e3d4b00093da4320e">&#9670;&nbsp;</a></span>rtems_rtl_trampoline_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool rtems_rtl_trampoline_add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrtems__rtl__obj.html">rtems_rtl_obj</a> *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>sect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="rtl-unresolved_8h.html#a5ab1ca8c94e49686f84f5ccf0731f0e6">rtems_rtl_word</a>&#160;</td>
          <td class="paramname"><em>symvalue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="rtl-unresolved_8h.html#a5ab1ca8c94e49686f84f5ccf0731f0e6">rtems_rtl_word</a> *&#160;</td>
          <td class="paramname"><em>rel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a relocation to the list of trampolinr relocations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">obj</td><td>The object table the relocation record is for. </td></tr>
    <tr><td class="paramname">flags</td><td>Format specific flags. </td></tr>
    <tr><td class="paramname">sect</td><td>The target section number the relocation references. </td></tr>
    <tr><td class="paramname">symvalue</td><td>The symbol's value. </td></tr>
    <tr><td class="paramname">rel</td><td>The format specific relocation data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>The relocation has been added. </td></tr>
    <tr><td class="paramname">false</td><td>The relocation could not be added. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a962fc939ba38c1794ff7acdb15cdfa16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a962fc939ba38c1794ff7acdb15cdfa16">&#9670;&nbsp;</a></span>rtems_rtl_trampoline_remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rtems_rtl_trampoline_remove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrtems__rtl__obj.html">rtems_rtl_obj</a> *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove the relocation records for an object file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">obj</td><td>The object table the symbols are for. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
