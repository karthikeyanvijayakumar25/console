<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RTEMS: Processor Dependent Interrupt Management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rtemslogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RTEMS
   &#160;<span id="projectnumber">5.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Processor Dependent Interrupt Management<div class="ingroups"><a class="el" href="group__RTEMSInternal.html">Internal</a> &raquo; <a class="el" href="group__RTEMSScore.html">SuperCore</a> &raquo; <a class="el" href="group__RTEMSScoreCPU.html">CPU Architecture Support</a> &raquo; <a class="el" href="group__RTEMSScoreCPUV850.html">V850</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gab94869be93a41da88a10fa59771ce2c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__RTEMSScoreCPUV850CPUInterrupt.html#gab94869be93a41da88a10fa59771ce2c9">CPU_MPCI_RECEIVE_SERVER_EXTRA_STACK</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:gab94869be93a41da88a10fa59771ce2c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47f6e4d60c72b5f65fc775b0b5dd14ec"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__RTEMSScoreCPUV850CPUInterrupt.html#ga47f6e4d60c72b5f65fc775b0b5dd14ec">CPU_PROVIDES_ISR_IS_IN_PROGRESS</a>&#160;&#160;&#160;<a class="el" href="group__RTEMSScoreBaseDefs.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td></tr>
<tr class="separator:ga47f6e4d60c72b5f65fc775b0b5dd14ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaca3fde6f372ee51fdd893c260e7d7146"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__RTEMSScoreCPUV850CPUInterrupt.html#gaca3fde6f372ee51fdd893c260e7d7146">_CPU_ISR_Disable</a>(_isr_cookie)</td></tr>
<tr class="separator:gaca3fde6f372ee51fdd893c260e7d7146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae3b1e2cd1ea4020d229e759569459664"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__RTEMSScoreCPUV850CPUInterrupt.html#gae3b1e2cd1ea4020d229e759569459664">_CPU_ISR_Enable</a>(_isr_cookie)</td></tr>
<tr class="separator:gae3b1e2cd1ea4020d229e759569459664"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac7e58e16c6b558daf31fe8f9dbec5a69"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__RTEMSScoreCPUV850CPUInterrupt.html#gac7e58e16c6b558daf31fe8f9dbec5a69">_CPU_ISR_Flash</a>(_isr_cookie)</td></tr>
<tr class="separator:gac7e58e16c6b558daf31fe8f9dbec5a69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaed8717a2f15938d954c7124cd11e899f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__RTEMSScoreCPUV850CPUInterrupt.html#gaed8717a2f15938d954c7124cd11e899f">_CPU_ISR_Set_level</a>(new_level)</td></tr>
<tr class="separator:gaed8717a2f15938d954c7124cd11e899f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga5254669b54a06e96ebb585fd50a02c4d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__RTEMSScoreBaseDefs.html#gac216239df231d5dbd15e3520b0b9313f">RTEMS_INLINE_ROUTINE</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__RTEMSScoreCPUV850CPUInterrupt.html#ga5254669b54a06e96ebb585fd50a02c4d">_CPU_ISR_Is_enabled</a> (uint32_t level)</td></tr>
<tr class="memdesc:ga5254669b54a06e96ebb585fd50a02c4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if interrupts are enabled in the specified ISR level, otherwise returns false.  <a href="#ga5254669b54a06e96ebb585fd50a02c4d">More...</a><br /></td></tr>
<tr class="separator:ga5254669b54a06e96ebb585fd50a02c4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1d9dcab9170d532b6634a5620385adbd"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__RTEMSScoreCPUV850CPUInterrupt.html#ga1d9dcab9170d532b6634a5620385adbd">_CPU_ISR_Get_level</a> (void)</td></tr>
<tr class="memdesc:ga1d9dcab9170d532b6634a5620385adbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the interrupt level of the executing thread.  <a href="#ga1d9dcab9170d532b6634a5620385adbd">More...</a><br /></td></tr>
<tr class="separator:ga1d9dcab9170d532b6634a5620385adbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The following defines the number of bits actually used in the interrupt field of the task mode. How those bits map to the CPU interrupt levels is defined by the routine <a class="el" href="group__RTEMSScoreCPUARM.html#ga43820ba3d51d7a699c22fce8cac93ef1">_CPU_ISR_Set_level</a>.</p>
<p>Port Specific Information:</p>
<p>The v850 only has a single bit in the CPU for interrupt disable/enable. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gaca3fde6f372ee51fdd893c260e7d7146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaca3fde6f372ee51fdd893c260e7d7146">&#9670;&nbsp;</a></span>_CPU_ISR_Disable</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _CPU_ISR_Disable</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_isr_cookie</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { \</div><div class="line">    unsigned <span class="keywordtype">int</span> _psw; \</div><div class="line">    \</div><div class="line">    v850_get_psw( _psw ); \</div><div class="line">    __asm__ __volatile__( <span class="stringliteral">&quot;di&quot;</span> ); \</div><div class="line">    _isr_cookie = _psw; \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div></div><!-- fragment --><p>Disable all interrupts for an RTEMS critical section. The previous level is returned in <em>_isr_cookie</em>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">_isr_cookie</td><td>will contain the previous level cookie</td></tr>
  </table>
  </dd>
</dl>
<p>Port Specific Information:</p>
<p>On the v850, we need to save the PSW and use "di" to disable interrupts. </p>

</div>
</div>
<a id="gae3b1e2cd1ea4020d229e759569459664"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae3b1e2cd1ea4020d229e759569459664">&#9670;&nbsp;</a></span>_CPU_ISR_Enable</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _CPU_ISR_Enable</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_isr_cookie</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { \</div><div class="line">    unsigned <span class="keywordtype">int</span> _psw = (_isr_cookie); \</div><div class="line">    \</div><div class="line">    v850_set_psw( _psw ); \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div></div><!-- fragment --><p>Enable interrupts to the previous level (returned by _CPU_ISR_Disable). This indicates the end of an RTEMS critical section. The parameter <em>_isr_cookie</em> is not modified.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">_isr_cookie</td><td>contain the previous level cookie</td></tr>
  </table>
  </dd>
</dl>
<p>Port Specific Information:</p>
<p>On the v850, we simply need to restore the PSW. </p>

</div>
</div>
<a id="gac7e58e16c6b558daf31fe8f9dbec5a69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac7e58e16c6b558daf31fe8f9dbec5a69">&#9670;&nbsp;</a></span>_CPU_ISR_Flash</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _CPU_ISR_Flash</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_isr_cookie</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { \</div><div class="line">    unsigned <span class="keywordtype">int</span> _psw = (_isr_cookie); \</div><div class="line">    v850_set_psw( _psw ); \</div><div class="line">    __asm__ __volatile__( <span class="stringliteral">&quot;di&quot;</span> ); \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div></div><!-- fragment --><p>This temporarily restores the interrupt to <em>_isr_cookie</em> before immediately disabling them again. This is used to divide long RTEMS critical sections into two or more parts. The parameter <em>_isr_cookie</em> is not modified.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">_isr_cookie</td><td>contain the previous level cookie</td></tr>
  </table>
  </dd>
</dl>
<p>Port Specific Information:</p>
<p>This saves at least one instruction over using enable/disable back to back. </p>

</div>
</div>
<a id="gaed8717a2f15938d954c7124cd11e899f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaed8717a2f15938d954c7124cd11e899f">&#9670;&nbsp;</a></span>_CPU_ISR_Set_level</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _CPU_ISR_Set_level</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">new_level</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { \</div><div class="line">    if ( new_level ) \</div><div class="line">      __asm__ __volatile__( <span class="stringliteral">&quot;di&quot;</span> ); \</div><div class="line">    else \</div><div class="line">      __asm__ __volatile__( <span class="stringliteral">&quot;ei&quot;</span> ); \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div></div><!-- fragment --><p>This routine and <a class="el" href="group__RTEMSScoreCPUARM.html#ga1d9dcab9170d532b6634a5620385adbd">_CPU_ISR_Get_level</a> Map the interrupt level in task mode onto the hardware that the CPU actually provides. Currently, interrupt levels which do not map onto the CPU in a generic fashion are undefined. Someday, it would be nice if these were "mapped" by the application via a callout. For example, m68k has 8 levels 0 - 7, levels 8 - 255 would be available for bsp/application specific meaning. This could be used to manage a programmable interrupt controller via the rtems_task_mode directive.</p>
<p>Port Specific Information:</p>
<p>On the v850, level 0 is enabled. Non-zero is disabled. </p>

</div>
</div>
<a id="gab94869be93a41da88a10fa59771ce2c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab94869be93a41da88a10fa59771ce2c9">&#9670;&nbsp;</a></span>CPU_MPCI_RECEIVE_SERVER_EXTRA_STACK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_MPCI_RECEIVE_SERVER_EXTRA_STACK&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Amount of extra stack (above minimum stack size) required by MPCI receive server thread. Remember that in a multiprocessor system this thread must exist and be able to process all directives.</p>
<p>Port Specific Information:</p>
<p>There is no reason to think the v850 needs extra MPCI receive server stack. </p>

</div>
</div>
<a id="ga47f6e4d60c72b5f65fc775b0b5dd14ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga47f6e4d60c72b5f65fc775b0b5dd14ec">&#9670;&nbsp;</a></span>CPU_PROVIDES_ISR_IS_IN_PROGRESS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_PROVIDES_ISR_IS_IN_PROGRESS&#160;&#160;&#160;<a class="el" href="group__RTEMSScoreBaseDefs.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is defined if the port has a special way to report the ISR nesting level. Most ports maintain the variable <em>_ISR_Nest_level</em>. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga1d9dcab9170d532b6634a5620385adbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1d9dcab9170d532b6634a5620385adbd">&#9670;&nbsp;</a></span>_CPU_ISR_Get_level()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t _CPU_ISR_Get_level </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the interrupt level of the executing thread. </p>
<p>Return the current interrupt disable level for this task in the format used by the interrupt level portion of the task mode.</p>
<dl class="section note"><dt>Note</dt><dd>This routine usually must be implemented as a subroutine.</dd></dl>
<p>Port Specific Information:</p>
<p>This method is implemented in C on the v850.</p>
<p>Obtain the current interrupt disable level.</p>
<p>Return the current interrupt disable level for this task in the format used by the interrupt level portion of the task mode.</p>
<dl class="section note"><dt>Note</dt><dd>This routine usually must be implemented as a subroutine.</dd></dl>
<p>Port Specific Information:</p>
<p>XXX document implementation including references if appropriate </p>

</div>
</div>
<a id="ga5254669b54a06e96ebb585fd50a02c4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5254669b54a06e96ebb585fd50a02c4d">&#9670;&nbsp;</a></span>_CPU_ISR_Is_enabled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__RTEMSScoreBaseDefs.html#gac216239df231d5dbd15e3520b0b9313f">RTEMS_INLINE_ROUTINE</a> bool _CPU_ISR_Is_enabled </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>level</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if interrupts are enabled in the specified ISR level, otherwise returns false. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>The ISR level.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Interrupts are enabled in the ISR level. </td></tr>
    <tr><td class="paramname">false</td><td>Otherwise. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
