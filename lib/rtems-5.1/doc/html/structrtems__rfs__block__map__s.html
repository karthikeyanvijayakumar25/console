<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RTEMS: rtems_rfs_block_map_s Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rtemslogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RTEMS
   &#160;<span id="projectnumber">5.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">rtems_rfs_block_map_s Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="rtems-rfs-block_8h_source.html">rtems-rfs-block.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:aa99bf6b6620b00c0bdd84a8703275437"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtems__rfs__block__map__s.html#aa99bf6b6620b00c0bdd84a8703275437">dirty</a></td></tr>
<tr class="separator:aa99bf6b6620b00c0bdd84a8703275437"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74f7b66eec17822aa175f0c19d61c28a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rtems-rfs-inode_8h.html#a91f02dac5a2d91e072d676f3266ab8d2">rtems_rfs_inode_handle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtems__rfs__block__map__s.html#a74f7b66eec17822aa175f0c19d61c28a">inode</a></td></tr>
<tr class="separator:a74f7b66eec17822aa175f0c19d61c28a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c5f3d804cf4bdf7dee7a6a93e85175b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rtems-rfs-block-pos_8h.html#aa72438eee22908110dc633ca6b89b390">rtems_rfs_block_size</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtems__rfs__block__map__s.html#a6c5f3d804cf4bdf7dee7a6a93e85175b">size</a></td></tr>
<tr class="separator:a6c5f3d804cf4bdf7dee7a6a93e85175b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5699833603dca58333e9d7f92d60cb86"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rtems-rfs-block-pos_8h.html#a0d8bd7482333e584a03df45e60cda226">rtems_rfs_block_pos</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtems__rfs__block__map__s.html#a5699833603dca58333e9d7f92d60cb86">bpos</a></td></tr>
<tr class="separator:a5699833603dca58333e9d7f92d60cb86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a982fb2a5ea76eb2dbb21dd76dca259e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rtems-rfs-block-pos_8h.html#abbf8bb95acf9bd16ed3291f7da518e9a">rtems_rfs_block_no</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtems__rfs__block__map__s.html#a982fb2a5ea76eb2dbb21dd76dca259e3">last_map_block</a></td></tr>
<tr class="separator:a982fb2a5ea76eb2dbb21dd76dca259e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8e110de9402ef2f75263c6a4244a5d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rtems-rfs-block-pos_8h.html#abbf8bb95acf9bd16ed3291f7da518e9a">rtems_rfs_block_no</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtems__rfs__block__map__s.html#ac8e110de9402ef2f75263c6a4244a5d8">last_data_block</a></td></tr>
<tr class="separator:ac8e110de9402ef2f75263c6a4244a5d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8358418370ab17c66051ee0d3f2abce2"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtems__rfs__block__map__s.html#a8358418370ab17c66051ee0d3f2abce2">blocks</a> [<a class="el" href="rtems-rfs-file-system_8h.html#a89ff31e716c58b51c65d688662acb012">RTEMS_RFS_INODE_BLOCKS</a>]</td></tr>
<tr class="separator:a8358418370ab17c66051ee0d3f2abce2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a406b38e6ceda414438ea3cea917a20b6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rtems-rfs-buffer_8h.html#a17f97c37c5273ad28d413dfd2d175e23">rtems_rfs_buffer_handle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtems__rfs__block__map__s.html#a406b38e6ceda414438ea3cea917a20b6">singly_buffer</a></td></tr>
<tr class="separator:a406b38e6ceda414438ea3cea917a20b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef2105d20cc64f7465a68a9c98c40413"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rtems-rfs-buffer_8h.html#a17f97c37c5273ad28d413dfd2d175e23">rtems_rfs_buffer_handle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtems__rfs__block__map__s.html#aef2105d20cc64f7465a68a9c98c40413">doubly_buffer</a></td></tr>
<tr class="separator:aef2105d20cc64f7465a68a9c98c40413"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A block map manges the block lists that originate from an inode. The inode contains a number of block numbers. A block map takes those block numbers and manages them.</p>
<p>The blocks cannot have all ones as a block number nor block 0. The block map is series of block numbers in a blocks. The size of the map determines the way the block numbers are stored. The map uses the following:</p>
<ul>
<li><em>Direct</em> Access, </li>
<li><em>Single</em> Indirect Access, and </li>
<li><em>Double</em> Indirect Access.</li>
</ul>
<p>Direct access has the blocks numbers in the inode slots. The Single Indirect Access has block numbers in the inode slots that pointer to a table of block numbers that point to data blocks. The Double Indirect Access has block numbers in the inode that point to Single Indirect block tables.</p>
<p>The inode can hold a number of Direct, Single Indirect, and Double Indirect block tables. The move from Direct to Single occurs then the block count in the map is above the number of slots in the inode. The move from Single to Double occurs when the map block count is greated than the block numbers per block multipled by the slots in the inode. The move from Single to Double occurs when the map block count is over the block numbers per block squared multipled by the number of slots in the inode.</p>
<p>The block map can managed files of the follow size verses block size with 5 inode slots:</p>
<ul>
<li>41,943,040 bytes for a 512 byte block size, </li>
<li>335,544,320 bytes for a 1024 byte block size, </li>
<li>2,684,354,560 bytes for a 2048 byte block size, and </li>
<li>21,474,836,480 bytes for a 4096 byte block size. </li>
</ul>
</div><h2 class="groupheader">Field Documentation</h2>
<a id="a8358418370ab17c66051ee0d3f2abce2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8358418370ab17c66051ee0d3f2abce2">&#9670;&nbsp;</a></span>blocks</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t rtems_rfs_block_map_s::blocks[<a class="el" href="rtems-rfs-file-system_8h.html#a89ff31e716c58b51c65d688662acb012">RTEMS_RFS_INODE_BLOCKS</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The block map. </p>

</div>
</div>
<a id="a5699833603dca58333e9d7f92d60cb86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5699833603dca58333e9d7f92d60cb86">&#9670;&nbsp;</a></span>bpos</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rtems-rfs-block-pos_8h.html#a0d8bd7482333e584a03df45e60cda226">rtems_rfs_block_pos</a> rtems_rfs_block_map_s::bpos</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The block map position. Used to navigate the map when seeking. The find call is to a position in the file/directory and is a block number plus offset. The block find only needs to locate a block and not worry about the offset while a seek can be less than a block size yet move across a block boundary. Therefore the position a block map has to maintain must include the offset so seeks work. </p>

</div>
</div>
<a id="aa99bf6b6620b00c0bdd84a8703275437"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa99bf6b6620b00c0bdd84a8703275437">&#9670;&nbsp;</a></span>dirty</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool rtems_rfs_block_map_s::dirty</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Is the map dirty ? </p>

</div>
</div>
<a id="aef2105d20cc64f7465a68a9c98c40413"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef2105d20cc64f7465a68a9c98c40413">&#9670;&nbsp;</a></span>doubly_buffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rtems-rfs-buffer_8h.html#a17f97c37c5273ad28d413dfd2d175e23">rtems_rfs_buffer_handle</a> rtems_rfs_block_map_s::doubly_buffer</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Doubly Buffer handle. </p>

</div>
</div>
<a id="a74f7b66eec17822aa175f0c19d61c28a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74f7b66eec17822aa175f0c19d61c28a">&#9670;&nbsp;</a></span>inode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rtems-rfs-inode_8h.html#a91f02dac5a2d91e072d676f3266ab8d2">rtems_rfs_inode_handle</a>* rtems_rfs_block_map_s::inode</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The inode this map is attached to. </p>

</div>
</div>
<a id="ac8e110de9402ef2f75263c6a4244a5d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8e110de9402ef2f75263c6a4244a5d8">&#9670;&nbsp;</a></span>last_data_block</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rtems-rfs-block-pos_8h.html#abbf8bb95acf9bd16ed3291f7da518e9a">rtems_rfs_block_no</a> rtems_rfs_block_map_s::last_data_block</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The last data block allocated. This is used as the goal when allocating a new data block. </p>

</div>
</div>
<a id="a982fb2a5ea76eb2dbb21dd76dca259e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a982fb2a5ea76eb2dbb21dd76dca259e3">&#9670;&nbsp;</a></span>last_map_block</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rtems-rfs-block-pos_8h.html#abbf8bb95acf9bd16ed3291f7da518e9a">rtems_rfs_block_no</a> rtems_rfs_block_map_s::last_map_block</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The last map block allocated. This is used as the goal when allocating a new map block. </p>

</div>
</div>
<a id="a406b38e6ceda414438ea3cea917a20b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a406b38e6ceda414438ea3cea917a20b6">&#9670;&nbsp;</a></span>singly_buffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rtems-rfs-buffer_8h.html#a17f97c37c5273ad28d413dfd2d175e23">rtems_rfs_buffer_handle</a> rtems_rfs_block_map_s::singly_buffer</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Singly Buffer handle. </p>

</div>
</div>
<a id="a6c5f3d804cf4bdf7dee7a6a93e85175b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c5f3d804cf4bdf7dee7a6a93e85175b">&#9670;&nbsp;</a></span>size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rtems-rfs-block-pos_8h.html#aa72438eee22908110dc633ca6b89b390">rtems_rfs_block_size</a> rtems_rfs_block_map_s::size</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The size of the map. </p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>cpukit/include/rtems/rfs/<a class="el" href="rtems-rfs-block_8h_source.html">rtems-rfs-block.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
