<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RTEMS: rtems_dosfs_mount_options Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rtemslogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RTEMS
   &#160;<span id="projectnumber">5.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">rtems_dosfs_mount_options Struct Reference<div class="ingroups"><a class="el" href="group__LibIO.html">IO Library</a> &raquo; <a class="el" href="group__FileSystemTypesAndMount.html">File System Types and Mount</a> &raquo; <a class="el" href="group__DOSFS.html">FAT Filesystem Support</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>FAT filesystem mount options.  
 <a href="structrtems__dosfs__mount__options.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="dosfs_8h_source.html">dosfs.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:af0fbb8805427b51c70d8637703af62d1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrtems__dosfs__convert__control.html">rtems_dosfs_convert_control</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtems__dosfs__mount__options.html#af0fbb8805427b51c70d8637703af62d1">converter</a></td></tr>
<tr class="memdesc:af0fbb8805427b51c70d8637703af62d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converter implementation for new file system instance.  <a href="#af0fbb8805427b51c70d8637703af62d1">More...</a><br /></td></tr>
<tr class="separator:af0fbb8805427b51c70d8637703af62d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>FAT filesystem mount options. </p>
</div><h2 class="groupheader">Field Documentation</h2>
<a id="af0fbb8805427b51c70d8637703af62d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0fbb8805427b51c70d8637703af62d1">&#9670;&nbsp;</a></span>converter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrtems__dosfs__convert__control.html">rtems_dosfs_convert_control</a>* rtems_dosfs_mount_options::converter</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converter implementation for new file system instance. </p>
<p>Note: If you pass a converter to mount, you have to destroy it yourself if mount failed. In a good case it is destroyed at unmount.</p>
<p>Before converters have been added to the RTEMS implementation of the FAT file system, the implementation was:</p><ul>
<li>Short names were saved in code page format (as is still the case).</li>
<li>Long names were not saved in UTF-16 format as mandated by the FAT file system specification. Instead the character in the local encoding was stored to the low byte directly and the high byte was set to zero.</li>
</ul>
<p>There are a few compatibility issues due to a non-standard conform implementation of the FAT file system before the UTF-8 support was added. These following issues affect the default converter and the UTF-8 converter:</p><ul>
<li>Before UTF-8 support was added, it was possible to create files with the the same short name in single case and mixed case in a directory. It was for example possible to have files "ABC" and "aBc" in a single directory. Now this bug is fixed.</li>
<li>Before UTF-8 support was added, it was possible to create files with a name length of slightly more than 255 characters. Now the implementation adheres exactly to the 255 character limit.</li>
<li>Long file names saved before UTF-8 support was added could contain non-ASCII characters in the low byte which was saved for a long name character. With the default converter this means such files can be read only by their short file name. With the UTF-8 converter file names will be read correctly as long as the characters written with the old implementation were Latin-1 characters.</li>
</ul>
<p>The following sample code demonstrates how to mount a file system with UTF-8 support: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;errno.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="assert_8h.html">assert.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dosfs_8h.html">rtems/dosfs.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="libio_8h.html">rtems/libio.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> mount_with_utf8(</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *device_file,</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *mount_point</div><div class="line">)</div><div class="line">{</div><div class="line">  <a class="code" href="structrtems__dosfs__convert__control.html">rtems_dosfs_convert_control</a> *convert_ctrl;</div><div class="line">  <span class="keywordtype">int</span>                          rv;</div><div class="line"></div><div class="line">  convert_ctrl = <a class="code" href="group__DOSFS.html#ga47cec61b81f7868a5b821709246a8509">rtems_dosfs_create_utf8_converter</a>( <span class="stringliteral">&quot;CP850&quot;</span> );</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> ( convert_ctrl != <a class="code" href="bestcomm__api_8h.html#a872bb74de61c3689ccd5b41873fce42c">NULL</a> ) {</div><div class="line">    <a class="code" href="structrtems__dosfs__mount__options.html">rtems_dosfs_mount_options</a> mount_opts;</div><div class="line"></div><div class="line">    memset( &amp;mount_opts, 0, <span class="keyword">sizeof</span>( mount_opts ) );</div><div class="line">    mount_opts.<a class="code" href="structrtems__dosfs__mount__options.html#af0fbb8805427b51c70d8637703af62d1">converter</a> = convert_ctrl;</div><div class="line"></div><div class="line">    rv = <a class="code" href="group__FileSystemTypesAndMount.html#ga27af6440b4ef795576c94e870c5d997f">mount_and_make_target_path</a>(</div><div class="line">      device_file,</div><div class="line">      mount_point,</div><div class="line">      RTEMS_FILESYSTEM_TYPE_DOSFS,</div><div class="line">      RTEMS_FILESYSTEM_READ_WRITE,</div><div class="line">      &amp;mount_opts</div><div class="line">    );</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (rv != 0) {</div><div class="line">      (*mount_opts.<a class="code" href="structrtems__dosfs__mount__options.html#af0fbb8805427b51c70d8637703af62d1">converter</a>-&gt;handler-&gt;destroy)(mount_opts.<a class="code" href="structrtems__dosfs__mount__options.html#af0fbb8805427b51c70d8637703af62d1">converter</a>);</div><div class="line">    }</div><div class="line">  } <span class="keywordflow">else</span> {</div><div class="line">    rv = -1;</div><div class="line">    errno = ENOMEM;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> rv;</div><div class="line">}</div></div><!-- fragment --><p>In case you do not want UTF-8 support, you can simply pass a NULL pointer to <a class="el" href="group__FileSystemTypesAndMount.html#ga27af6440b4ef795576c94e870c5d997f" title="Mounts a file system and makes the target path.">mount_and_make_target_path()</a> respectively to <a class="el" href="group__FileSystemTypesAndMount.html#gaf3c1bed49bb0f3dec88d330b4f88d48b" title="Mounts a file system instance at the specified target path.">mount()</a> instead of the mount_opts address.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__DOSFS.html#ga9dc28ad698d4946c7bf691fa0b0a6c78" title="Allocates and initializes a default converter.">rtems_dosfs_create_default_converter()</a> and <a class="el" href="group__DOSFS.html#ga47cec61b81f7868a5b821709246a8509" title="Allocates and initializes a UTF-8 converter.">rtems_dosfs_create_utf8_converter()</a>. </dd></dl>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>cpukit/include/rtems/<a class="el" href="dosfs_8h_source.html">dosfs.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
