\hypertarget{group__rtems__blkdev}{}\section{Block Device Management}
\label{group__rtems__blkdev}\index{Block Device Management@{Block Device Management}}
\subsection*{Modules}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{group__RTEMSFDisk}{Flash Disk Device}}
\item 
\mbox{\hyperlink{group__rtems__blkdev__generic}{Generic Disk Device}}
\item 
\mbox{\hyperlink{group__rtems__ramdisk}{R\+A\+M Disk Device}}
\item 
\mbox{\hyperlink{group__rtems__sparse__disk}{Sparse Disk Device}}
\end{DoxyCompactItemize}
\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \mbox{\hyperlink{blkdev_8h}{blkdev.\+h}}
\begin{DoxyCompactList}\small\item\em Block Device Management. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{blkdev-blkstats_8c}{blkdev-\/blkstats.\+c}}
\begin{DoxyCompactList}\small\item\em Block Device Statistics Command. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{blkdev-ioctl_8c}{blkdev-\/ioctl.\+c}}
\begin{DoxyCompactList}\small\item\em Common \mbox{\hyperlink{structIO}{IO}} Control Primitive. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{blkdev-ops_8c}{blkdev-\/ops.\+c}}
\begin{DoxyCompactList}\small\item\em Block device management. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{blkdev-print-stats_8c}{blkdev-\/print-\/stats.\+c}}
\begin{DoxyCompactList}\small\item\em Prints the Block Device Statistics. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{blkdev_8c}{blkdev.\+c}}
\begin{DoxyCompactList}\small\item\em Block Device Management. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structrtems__blkdev__sg__buffer}{rtems\+\_\+blkdev\+\_\+sg\+\_\+buffer}}
\begin{DoxyCompactList}\small\item\em Block device scatter or gather buffer structure. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structrtems__blkdev__request}{rtems\+\_\+blkdev\+\_\+request}}
\begin{DoxyCompactList}\small\item\em The block device transfer request is used to read or write a number of blocks from or to the device. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{group__rtems__blkdev_ga1dd3697d64b56629c38f43b1f5615914}{R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+D\+E\+V\+\_\+\+S\+T\+A\+R\+T\+\_\+\+B\+L\+O\+CK}}(req)~(req-\/$>$bufs\mbox{[}0\mbox{]}.block)
\begin{DoxyCompactList}\small\item\em The start block in a request. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef enum \mbox{\hyperlink{group__rtems__blkdev_ga36465495f1b9e28347838751ca90f0fe}{rtems\+\_\+blkdev\+\_\+request\+\_\+op}} \mbox{\hyperlink{group__rtems__blkdev_ga3f09489ef7c88b70744a747573f5b741}{rtems\+\_\+blkdev\+\_\+request\+\_\+op}}
\begin{DoxyCompactList}\small\item\em Block device request type. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__rtems__blkdev_ga64a394fd9c40d7e2d1d22441741b6c83}\label{group__rtems__blkdev_ga64a394fd9c40d7e2d1d22441741b6c83}} 
typedef void($\ast$ \mbox{\hyperlink{group__rtems__blkdev_ga64a394fd9c40d7e2d1d22441741b6c83}{rtems\+\_\+blkdev\+\_\+request\+\_\+cb}}) (struct \mbox{\hyperlink{structrtems__blkdev__request}{rtems\+\_\+blkdev\+\_\+request}} $\ast$req, \mbox{\hyperlink{group__ClassicStatus_ga545d41846817eaba6143d52ee4d9e9fe}{rtems\+\_\+status\+\_\+code}} status)
\begin{DoxyCompactList}\small\item\em Block device request done callback function type. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__rtems__blkdev_ga78d471b21ee2156476d4aa0b1cf0abe0}\label{group__rtems__blkdev_ga78d471b21ee2156476d4aa0b1cf0abe0}} 
typedef struct \mbox{\hyperlink{structrtems__blkdev__sg__buffer}{rtems\+\_\+blkdev\+\_\+sg\+\_\+buffer}} \mbox{\hyperlink{group__rtems__blkdev_ga78d471b21ee2156476d4aa0b1cf0abe0}{rtems\+\_\+blkdev\+\_\+sg\+\_\+buffer}}
\begin{DoxyCompactList}\small\item\em Block device scatter or gather buffer structure. \end{DoxyCompactList}\item 
typedef struct \mbox{\hyperlink{structrtems__blkdev__request}{rtems\+\_\+blkdev\+\_\+request}} \mbox{\hyperlink{group__rtems__blkdev_gac77b556344073a161224333b6c605608}{rtems\+\_\+blkdev\+\_\+request}}
\begin{DoxyCompactList}\small\item\em The block device transfer request is used to read or write a number of blocks from or to the device. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{group__rtems__blkdev_ga36465495f1b9e28347838751ca90f0fe}{rtems\+\_\+blkdev\+\_\+request\+\_\+op}} \{ \mbox{\hyperlink{group__rtems__blkdev_gga36465495f1b9e28347838751ca90f0fea093ae86fe53f5ba14f85119f890c05ca}{R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+D\+E\+V\+\_\+\+R\+E\+Q\+\_\+\+R\+E\+AD}}, 
\mbox{\hyperlink{group__rtems__blkdev_gga36465495f1b9e28347838751ca90f0feadd7b428e4168a2256b2797fff07b22e7}{R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+D\+E\+V\+\_\+\+R\+E\+Q\+\_\+\+W\+R\+I\+TE}}, 
\mbox{\hyperlink{group__rtems__blkdev_gga36465495f1b9e28347838751ca90f0feaa2108d42eb1d1d49a81025f6022fa35e}{R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+D\+E\+V\+\_\+\+R\+E\+Q\+\_\+\+S\+Y\+NC}}
 \}
\begin{DoxyCompactList}\small\item\em Block device request type. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{group__rtems__blkdev_gab555c151c08cc5ec60ccea5d24052d23}{rtems\+\_\+blkdev\+\_\+ioctl}} (\mbox{\hyperlink{structrtems__disk__device}{rtems\+\_\+disk\+\_\+device}} $\ast$dd, uint32\+\_\+t req, void $\ast$argp)
\begin{DoxyCompactList}\small\item\em Common \mbox{\hyperlink{structIO}{IO}} control primitive. \end{DoxyCompactList}\item 
\mbox{\hyperlink{group__ClassicStatus_ga545d41846817eaba6143d52ee4d9e9fe}{rtems\+\_\+status\+\_\+code}} \mbox{\hyperlink{group__rtems__blkdev_gae2fe7e8c05fa9db0fa7c0ec4e8e4967d}{rtems\+\_\+blkdev\+\_\+create}} (const char $\ast$\mbox{\hyperlink{structdevice}{device}}, uint32\+\_\+t media\+\_\+block\+\_\+size, \mbox{\hyperlink{group__rtems__disk_ga5fbcfd40b657bff6c54d9e393fab3274}{rtems\+\_\+blkdev\+\_\+bnum}} media\+\_\+block\+\_\+count, \mbox{\hyperlink{group__rtems__disk_gacbf717f10129b976deaf8e6f4deb17ad}{rtems\+\_\+block\+\_\+device\+\_\+ioctl}} handler, void $\ast$driver\+\_\+data)
\begin{DoxyCompactList}\small\item\em Creates a block device. \end{DoxyCompactList}\item 
\mbox{\hyperlink{group__ClassicStatus_ga545d41846817eaba6143d52ee4d9e9fe}{rtems\+\_\+status\+\_\+code}} \mbox{\hyperlink{group__rtems__blkdev_ga9271a94a55c2d58494b2a43dcb55e13e}{rtems\+\_\+blkdev\+\_\+create\+\_\+partition}} (const char $\ast$\mbox{\hyperlink{structpartition}{partition}}, const char $\ast$parent\+\_\+block\+\_\+device, \mbox{\hyperlink{group__rtems__disk_ga5fbcfd40b657bff6c54d9e393fab3274}{rtems\+\_\+blkdev\+\_\+bnum}} media\+\_\+block\+\_\+begin, \mbox{\hyperlink{group__rtems__disk_ga5fbcfd40b657bff6c54d9e393fab3274}{rtems\+\_\+blkdev\+\_\+bnum}} media\+\_\+block\+\_\+count)
\begin{DoxyCompactList}\small\item\em Creates a partition within a parent block device. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__rtems__blkdev_gab318e4ab409ba1adb81fd6ad21314656}\label{group__rtems__blkdev_gab318e4ab409ba1adb81fd6ad21314656}} 
void \mbox{\hyperlink{group__rtems__blkdev_gab318e4ab409ba1adb81fd6ad21314656}{rtems\+\_\+blkdev\+\_\+print\+\_\+stats}} (const \mbox{\hyperlink{structrtems__blkdev__stats}{rtems\+\_\+blkdev\+\_\+stats}} $\ast$stats, uint32\+\_\+t media\+\_\+block\+\_\+size, uint32\+\_\+t media\+\_\+block\+\_\+count, uint32\+\_\+t block\+\_\+size, const \mbox{\hyperlink{structrtems__printer}{rtems\+\_\+printer}} $\ast$printer)
\begin{DoxyCompactList}\small\item\em Prints the block device statistics. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__rtems__blkdev_gac171a347539842982856bb7b32dd4e76}\label{group__rtems__blkdev_gac171a347539842982856bb7b32dd4e76}} 
void \mbox{\hyperlink{group__rtems__blkdev_gac171a347539842982856bb7b32dd4e76}{rtems\+\_\+blkstats}} (const \mbox{\hyperlink{structrtems__printer}{rtems\+\_\+printer}} $\ast$printer, const char $\ast$\mbox{\hyperlink{structdevice}{device}}, bool reset)
\begin{DoxyCompactList}\small\item\em Block device statistics command. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{IO Control Request Codes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group__rtems__blkdev_ga86e35845b31fe29df9713374bcbd6411}\label{group__rtems__blkdev_ga86e35845b31fe29df9713374bcbd6411}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+R\+E\+Q\+U\+E\+ST}~\+\_\+\+I\+O\+WR(\textquotesingle{}B\textquotesingle{}, 1, \mbox{\hyperlink{structrtems__blkdev__request}{rtems\+\_\+blkdev\+\_\+request}})
\item 
\mbox{\Hypertarget{group__rtems__blkdev_ga2d83b2b3ae01f5de3144ed98e6718a0d}\label{group__rtems__blkdev_ga2d83b2b3ae01f5de3144ed98e6718a0d}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+G\+E\+T\+M\+E\+D\+I\+A\+B\+L\+K\+S\+I\+ZE}~\+\_\+\+I\+OR(\textquotesingle{}B\textquotesingle{}, 2, uint32\+\_\+t)
\item 
\mbox{\Hypertarget{group__rtems__blkdev_ga723541bc5fa6d7d34ae7c75c01ca97fb}\label{group__rtems__blkdev_ga723541bc5fa6d7d34ae7c75c01ca97fb}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+G\+E\+T\+B\+L\+K\+S\+I\+ZE}~\+\_\+\+I\+OR(\textquotesingle{}B\textquotesingle{}, 3, uint32\+\_\+t)
\item 
\mbox{\Hypertarget{group__rtems__blkdev_gaf3d1317e63b50c8fe7cc2bf48a9d842b}\label{group__rtems__blkdev_gaf3d1317e63b50c8fe7cc2bf48a9d842b}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+S\+E\+T\+B\+L\+K\+S\+I\+ZE}~\+\_\+\+I\+OW(\textquotesingle{}B\textquotesingle{}, 4, uint32\+\_\+t)
\item 
\mbox{\Hypertarget{group__rtems__blkdev_ga3ac396d5a7f0def87d64bc2621eb9f7e}\label{group__rtems__blkdev_ga3ac396d5a7f0def87d64bc2621eb9f7e}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+G\+E\+T\+S\+I\+ZE}~\+\_\+\+I\+OR(\textquotesingle{}B\textquotesingle{}, 5, \mbox{\hyperlink{group__rtems__disk_ga5fbcfd40b657bff6c54d9e393fab3274}{rtems\+\_\+blkdev\+\_\+bnum}})
\item 
\mbox{\Hypertarget{group__rtems__blkdev_gaeb94a19fb76fd7fe974a018aca089412}\label{group__rtems__blkdev_gaeb94a19fb76fd7fe974a018aca089412}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+S\+Y\+N\+C\+D\+EV}~\+\_\+\+IO(\textquotesingle{}B\textquotesingle{}, 6)
\item 
\mbox{\Hypertarget{group__rtems__blkdev_ga4b23063186bf53a369ab16430ac1a38a}\label{group__rtems__blkdev_ga4b23063186bf53a369ab16430ac1a38a}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+D\+E\+L\+E\+T\+ED}~\+\_\+\+IO(\textquotesingle{}B\textquotesingle{}, 7)
\item 
\mbox{\Hypertarget{group__rtems__blkdev_gaf221d1d0367d25bf1e4996b4080ccb0c}\label{group__rtems__blkdev_gaf221d1d0367d25bf1e4996b4080ccb0c}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+C\+A\+P\+A\+B\+I\+L\+I\+T\+I\+ES}~\+\_\+\+IO(\textquotesingle{}B\textquotesingle{}, 8)
\item 
\mbox{\Hypertarget{group__rtems__blkdev_ga1d4cf51d33c09890769c90a4966dd62a}\label{group__rtems__blkdev_ga1d4cf51d33c09890769c90a4966dd62a}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+G\+E\+T\+D\+I\+S\+K\+D\+EV}~\+\_\+\+I\+OR(\textquotesingle{}B\textquotesingle{}, 9, \mbox{\hyperlink{structrtems__disk__device}{rtems\+\_\+disk\+\_\+device}} $\ast$)
\item 
\mbox{\Hypertarget{group__rtems__blkdev_ga93fc9d74a35bcddfb7f039e49fa33b5e}\label{group__rtems__blkdev_ga93fc9d74a35bcddfb7f039e49fa33b5e}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+P\+U\+R\+G\+E\+D\+EV}~\+\_\+\+IO(\textquotesingle{}B\textquotesingle{}, 10)
\item 
\mbox{\Hypertarget{group__rtems__blkdev_gaf958bca8306abeeb0395040dc7712df2}\label{group__rtems__blkdev_gaf958bca8306abeeb0395040dc7712df2}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+G\+E\+T\+D\+E\+V\+S\+T\+A\+TS}~\+\_\+\+I\+OR(\textquotesingle{}B\textquotesingle{}, 11, \mbox{\hyperlink{structrtems__blkdev__stats}{rtems\+\_\+blkdev\+\_\+stats}} $\ast$)
\item 
\mbox{\Hypertarget{group__rtems__blkdev_ga257b1b95cc4b0ef5fe87cf7beb6ec4ac}\label{group__rtems__blkdev_ga257b1b95cc4b0ef5fe87cf7beb6ec4ac}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+R\+E\+S\+E\+T\+D\+E\+V\+S\+T\+A\+TS}~\+\_\+\+IO(\textquotesingle{}B\textquotesingle{}, 12)
\end{DoxyCompactItemize}
\subsection*{Block Device Driver Capabilities}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{group__rtems__blkdev_ga25f2de1a9746d8b7d016ae12c51d5328}{R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+D\+E\+V\+\_\+\+C\+A\+P\+\_\+\+M\+U\+L\+T\+I\+S\+E\+C\+T\+O\+R\+\_\+\+C\+O\+NT}}~(1 $<$$<$ 0)
\begin{DoxyCompactList}\small\item\em Only consecutive multi-\/sector buffer requests are supported. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{group__rtems__blkdev_gab3164c0a50bb161d4a99177e1f08ef52}{R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+D\+E\+V\+\_\+\+C\+A\+P\+\_\+\+S\+Y\+NC}}~(1 $<$$<$ 1)
\begin{DoxyCompactList}\small\item\em The driver will accept a sync call. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Interface between device drivers and the \mbox{\hyperlink{group__rtems__bdbuf}{block device buffer module}}.

The heart of the block device driver is the R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+R\+E\+Q\+U\+E\+ST \mbox{\hyperlink{structIO}{IO}} control. This call puts \mbox{\hyperlink{structIO}{IO}} \mbox{\hyperlink{structrtems__blkdev__request}{requests}} to the block device for asynchronous processing. When a driver executes a request, it invokes the request done callback function to finish the request. 

\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{group__rtems__blkdev_ga25f2de1a9746d8b7d016ae12c51d5328}\label{group__rtems__blkdev_ga25f2de1a9746d8b7d016ae12c51d5328}} 
\index{Block Device Management@{Block Device Management}!RTEMS\_BLKDEV\_CAP\_MULTISECTOR\_CONT@{RTEMS\_BLKDEV\_CAP\_MULTISECTOR\_CONT}}
\index{RTEMS\_BLKDEV\_CAP\_MULTISECTOR\_CONT@{RTEMS\_BLKDEV\_CAP\_MULTISECTOR\_CONT}!Block Device Management@{Block Device Management}}
\subsubsection{\texorpdfstring{RTEMS\_BLKDEV\_CAP\_MULTISECTOR\_CONT}{RTEMS\_BLKDEV\_CAP\_MULTISECTOR\_CONT}}
{\footnotesize\ttfamily \#define R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+D\+E\+V\+\_\+\+C\+A\+P\+\_\+\+M\+U\+L\+T\+I\+S\+E\+C\+T\+O\+R\+\_\+\+C\+O\+NT~(1 $<$$<$ 0)}



Only consecutive multi-\/sector buffer requests are supported. 

This option means the cache will only supply multiple buffers that are inorder so the A\+TA multi-\/sector command for example can be used. This is a hack to work around the current A\+TA driver. \mbox{\Hypertarget{group__rtems__blkdev_gab3164c0a50bb161d4a99177e1f08ef52}\label{group__rtems__blkdev_gab3164c0a50bb161d4a99177e1f08ef52}} 
\index{Block Device Management@{Block Device Management}!RTEMS\_BLKDEV\_CAP\_SYNC@{RTEMS\_BLKDEV\_CAP\_SYNC}}
\index{RTEMS\_BLKDEV\_CAP\_SYNC@{RTEMS\_BLKDEV\_CAP\_SYNC}!Block Device Management@{Block Device Management}}
\subsubsection{\texorpdfstring{RTEMS\_BLKDEV\_CAP\_SYNC}{RTEMS\_BLKDEV\_CAP\_SYNC}}
{\footnotesize\ttfamily \#define R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+D\+E\+V\+\_\+\+C\+A\+P\+\_\+\+S\+Y\+NC~(1 $<$$<$ 1)}



The driver will accept a sync call. 

A sync call is made to a driver after a bdbuf cache sync has finished. \mbox{\Hypertarget{group__rtems__blkdev_ga1dd3697d64b56629c38f43b1f5615914}\label{group__rtems__blkdev_ga1dd3697d64b56629c38f43b1f5615914}} 
\index{Block Device Management@{Block Device Management}!RTEMS\_BLKDEV\_START\_BLOCK@{RTEMS\_BLKDEV\_START\_BLOCK}}
\index{RTEMS\_BLKDEV\_START\_BLOCK@{RTEMS\_BLKDEV\_START\_BLOCK}!Block Device Management@{Block Device Management}}
\subsubsection{\texorpdfstring{RTEMS\_BLKDEV\_START\_BLOCK}{RTEMS\_BLKDEV\_START\_BLOCK}}
{\footnotesize\ttfamily \#define R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+D\+E\+V\+\_\+\+S\+T\+A\+R\+T\+\_\+\+B\+L\+O\+CK(\begin{DoxyParamCaption}\item[{}]{req }\end{DoxyParamCaption})~(req-\/$>$bufs\mbox{[}0\mbox{]}.block)}



The start block in a request. 

Only valid if the driver has returned the \mbox{\hyperlink{group__rtems__blkdev_ga25f2de1a9746d8b7d016ae12c51d5328}{R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+D\+E\+V\+\_\+\+C\+A\+P\+\_\+\+M\+U\+L\+T\+I\+S\+E\+C\+T\+O\+R\+\_\+\+C\+O\+NT}} capability. 

\subsection{Typedef Documentation}
\mbox{\Hypertarget{group__rtems__blkdev_gac77b556344073a161224333b6c605608}\label{group__rtems__blkdev_gac77b556344073a161224333b6c605608}} 
\index{Block Device Management@{Block Device Management}!rtems\_blkdev\_request@{rtems\_blkdev\_request}}
\index{rtems\_blkdev\_request@{rtems\_blkdev\_request}!Block Device Management@{Block Device Management}}
\subsubsection{\texorpdfstring{rtems\_blkdev\_request}{rtems\_blkdev\_request}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structrtems__blkdev__request}{rtems\+\_\+blkdev\+\_\+request}}  \mbox{\hyperlink{structrtems__blkdev__request}{rtems\+\_\+blkdev\+\_\+request}}}



The block device transfer request is used to read or write a number of blocks from or to the device. 

Transfer requests are issued to the disk device driver with the R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+I\+O\+\_\+\+R\+E\+Q\+U\+E\+ST \mbox{\hyperlink{structIO}{IO}} control. The transfer request completion status must be signalled with rtems\+\_\+blkdev\+\_\+request\+\_\+done(). This function must be called exactly once per request. The return value of the \mbox{\hyperlink{structIO}{IO}} control will be ignored for transfer requests.

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{group__rtems__blkdev_gae2fe7e8c05fa9db0fa7c0ec4e8e4967d}{rtems\+\_\+blkdev\+\_\+create()}}. 
\end{DoxySeeAlso}
\mbox{\Hypertarget{group__rtems__blkdev_ga3f09489ef7c88b70744a747573f5b741}\label{group__rtems__blkdev_ga3f09489ef7c88b70744a747573f5b741}} 
\index{Block Device Management@{Block Device Management}!rtems\_blkdev\_request\_op@{rtems\_blkdev\_request\_op}}
\index{rtems\_blkdev\_request\_op@{rtems\_blkdev\_request\_op}!Block Device Management@{Block Device Management}}
\subsubsection{\texorpdfstring{rtems\_blkdev\_request\_op}{rtems\_blkdev\_request\_op}}
{\footnotesize\ttfamily typedef enum \mbox{\hyperlink{group__rtems__blkdev_ga36465495f1b9e28347838751ca90f0fe}{rtems\+\_\+blkdev\+\_\+request\+\_\+op}}  \mbox{\hyperlink{group__rtems__blkdev_ga36465495f1b9e28347838751ca90f0fe}{rtems\+\_\+blkdev\+\_\+request\+\_\+op}}}



Block device request type. 

\begin{DoxyWarning}{Warning}
The sync request is an \mbox{\hyperlink{structIO}{IO}} one and only used from the cache. Use the Block \mbox{\hyperlink{structIO}{IO}} when operating at the device level. We need a sync request to avoid requests looping for ever. 
\end{DoxyWarning}


\subsection{Enumeration Type Documentation}
\mbox{\Hypertarget{group__rtems__blkdev_ga36465495f1b9e28347838751ca90f0fe}\label{group__rtems__blkdev_ga36465495f1b9e28347838751ca90f0fe}} 
\index{Block Device Management@{Block Device Management}!rtems\_blkdev\_request\_op@{rtems\_blkdev\_request\_op}}
\index{rtems\_blkdev\_request\_op@{rtems\_blkdev\_request\_op}!Block Device Management@{Block Device Management}}
\subsubsection{\texorpdfstring{rtems\_blkdev\_request\_op}{rtems\_blkdev\_request\_op}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{group__rtems__blkdev_ga36465495f1b9e28347838751ca90f0fe}{rtems\+\_\+blkdev\+\_\+request\+\_\+op}}}



Block device request type. 

\begin{DoxyWarning}{Warning}
The sync request is an \mbox{\hyperlink{structIO}{IO}} one and only used from the cache. Use the Block \mbox{\hyperlink{structIO}{IO}} when operating at the device level. We need a sync request to avoid requests looping for ever. 
\end{DoxyWarning}
\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{RTEMS\_BLKDEV\_REQ\_READ@{RTEMS\_BLKDEV\_REQ\_READ}!Block Device Management@{Block Device Management}}\index{Block Device Management@{Block Device Management}!RTEMS\_BLKDEV\_REQ\_READ@{RTEMS\_BLKDEV\_REQ\_READ}}}\mbox{\Hypertarget{group__rtems__blkdev_gga36465495f1b9e28347838751ca90f0fea093ae86fe53f5ba14f85119f890c05ca}\label{group__rtems__blkdev_gga36465495f1b9e28347838751ca90f0fea093ae86fe53f5ba14f85119f890c05ca}} 
R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+D\+E\+V\+\_\+\+R\+E\+Q\+\_\+\+R\+E\+AD&Read the requested blocks of data. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{RTEMS\_BLKDEV\_REQ\_WRITE@{RTEMS\_BLKDEV\_REQ\_WRITE}!Block Device Management@{Block Device Management}}\index{Block Device Management@{Block Device Management}!RTEMS\_BLKDEV\_REQ\_WRITE@{RTEMS\_BLKDEV\_REQ\_WRITE}}}\mbox{\Hypertarget{group__rtems__blkdev_gga36465495f1b9e28347838751ca90f0feadd7b428e4168a2256b2797fff07b22e7}\label{group__rtems__blkdev_gga36465495f1b9e28347838751ca90f0feadd7b428e4168a2256b2797fff07b22e7}} 
R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+D\+E\+V\+\_\+\+R\+E\+Q\+\_\+\+W\+R\+I\+TE&Write the requested blocks of data. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{RTEMS\_BLKDEV\_REQ\_SYNC@{RTEMS\_BLKDEV\_REQ\_SYNC}!Block Device Management@{Block Device Management}}\index{Block Device Management@{Block Device Management}!RTEMS\_BLKDEV\_REQ\_SYNC@{RTEMS\_BLKDEV\_REQ\_SYNC}}}\mbox{\Hypertarget{group__rtems__blkdev_gga36465495f1b9e28347838751ca90f0feaa2108d42eb1d1d49a81025f6022fa35e}\label{group__rtems__blkdev_gga36465495f1b9e28347838751ca90f0feaa2108d42eb1d1d49a81025f6022fa35e}} 
R\+T\+E\+M\+S\+\_\+\+B\+L\+K\+D\+E\+V\+\_\+\+R\+E\+Q\+\_\+\+S\+Y\+NC&Sync any data with the media. \\
\hline

\end{DoxyEnumFields}


\subsection{Function Documentation}
\mbox{\Hypertarget{group__rtems__blkdev_gae2fe7e8c05fa9db0fa7c0ec4e8e4967d}\label{group__rtems__blkdev_gae2fe7e8c05fa9db0fa7c0ec4e8e4967d}} 
\index{Block Device Management@{Block Device Management}!rtems\_blkdev\_create@{rtems\_blkdev\_create}}
\index{rtems\_blkdev\_create@{rtems\_blkdev\_create}!Block Device Management@{Block Device Management}}
\subsubsection{\texorpdfstring{rtems\_blkdev\_create()}{rtems\_blkdev\_create()}}
{\footnotesize\ttfamily \mbox{\hyperlink{group__ClassicStatus_ga545d41846817eaba6143d52ee4d9e9fe}{rtems\+\_\+status\+\_\+code}} rtems\+\_\+blkdev\+\_\+create (\begin{DoxyParamCaption}\item[{const char $\ast$}]{device,  }\item[{uint32\+\_\+t}]{media\+\_\+block\+\_\+size,  }\item[{\mbox{\hyperlink{group__rtems__disk_ga5fbcfd40b657bff6c54d9e393fab3274}{rtems\+\_\+blkdev\+\_\+bnum}}}]{media\+\_\+block\+\_\+count,  }\item[{\mbox{\hyperlink{group__rtems__disk_gacbf717f10129b976deaf8e6f4deb17ad}{rtems\+\_\+block\+\_\+device\+\_\+ioctl}}}]{handler,  }\item[{void $\ast$}]{driver\+\_\+data }\end{DoxyParamCaption})}



Creates a block device. 

The block size is set to the media block size.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em device} & The path for the new block device. \\
\hline
\mbox{\texttt{ in}}  & {\em media\+\_\+block\+\_\+size} & The media block size in bytes. Must be positive. \\
\hline
\mbox{\texttt{ in}}  & {\em media\+\_\+block\+\_\+count} & The media block count. Must be positive. \\
\hline
\mbox{\texttt{ in}}  & {\em handler} & The block device \mbox{\hyperlink{structIO}{IO}} control handler. Must not be {\ttfamily N\+U\+LL}. \\
\hline
\mbox{\texttt{ in}}  & {\em driver\+\_\+data} & The block device driver data.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em R\+T\+E\+M\+S\+\_\+\+S\+U\+C\+C\+E\+S\+S\+F\+UL} & Successful operation. \\
\hline
{\em R\+T\+E\+M\+S\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+N\+U\+M\+B\+ER} & Media block size or count is not positive. \\
\hline
{\em R\+T\+E\+M\+S\+\_\+\+N\+O\+\_\+\+M\+E\+M\+O\+RY} & Not enough memory. \\
\hline
{\em R\+T\+E\+M\+S\+\_\+\+U\+N\+S\+A\+T\+I\+S\+F\+I\+ED} & Cannot create generic device node. \\
\hline
{\em R\+T\+E\+M\+S\+\_\+\+I\+N\+C\+O\+R\+R\+E\+C\+T\+\_\+\+S\+T\+A\+TE} & Cannot initialize bdbuf.\\
\hline
\end{DoxyRetVals}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{group__rtems__blkdev_ga9271a94a55c2d58494b2a43dcb55e13e}{rtems\+\_\+blkdev\+\_\+create\+\_\+partition()}}, \mbox{\hyperlink{group__rtems__bdbuf_ga649b3b4fb368921f579a0204552a7a60}{rtems\+\_\+bdbuf\+\_\+set\+\_\+block\+\_\+size()}}, and \mbox{\hyperlink{structrtems__blkdev__request}{rtems\+\_\+blkdev\+\_\+request}}. 
\end{DoxySeeAlso}
\mbox{\Hypertarget{group__rtems__blkdev_ga9271a94a55c2d58494b2a43dcb55e13e}\label{group__rtems__blkdev_ga9271a94a55c2d58494b2a43dcb55e13e}} 
\index{Block Device Management@{Block Device Management}!rtems\_blkdev\_create\_partition@{rtems\_blkdev\_create\_partition}}
\index{rtems\_blkdev\_create\_partition@{rtems\_blkdev\_create\_partition}!Block Device Management@{Block Device Management}}
\subsubsection{\texorpdfstring{rtems\_blkdev\_create\_partition()}{rtems\_blkdev\_create\_partition()}}
{\footnotesize\ttfamily \mbox{\hyperlink{group__ClassicStatus_ga545d41846817eaba6143d52ee4d9e9fe}{rtems\+\_\+status\+\_\+code}} rtems\+\_\+blkdev\+\_\+create\+\_\+partition (\begin{DoxyParamCaption}\item[{const char $\ast$}]{partition,  }\item[{const char $\ast$}]{parent\+\_\+block\+\_\+device,  }\item[{\mbox{\hyperlink{group__rtems__disk_ga5fbcfd40b657bff6c54d9e393fab3274}{rtems\+\_\+blkdev\+\_\+bnum}}}]{media\+\_\+block\+\_\+begin,  }\item[{\mbox{\hyperlink{group__rtems__disk_ga5fbcfd40b657bff6c54d9e393fab3274}{rtems\+\_\+blkdev\+\_\+bnum}}}]{media\+\_\+block\+\_\+count }\end{DoxyParamCaption})}



Creates a partition within a parent block device. 

A partition manages a subset of consecutive blocks contained in a parent block device. The blocks must be within the range of blocks managed by the associated parent block device. The media block size and \mbox{\hyperlink{structIO}{IO}} control handler are inherited by the parent block device. The block size is set to the media block size.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em partition} & The path for the new partition device. \\
\hline
\mbox{\texttt{ in}}  & {\em parent\+\_\+block\+\_\+device} & The parent block device path. \\
\hline
\mbox{\texttt{ in}}  & {\em media\+\_\+block\+\_\+begin} & The media block begin of the partition within the parent block device. \\
\hline
\mbox{\texttt{ in}}  & {\em media\+\_\+block\+\_\+count} & The media block count of the partition.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em R\+T\+E\+M\+S\+\_\+\+S\+U\+C\+C\+E\+S\+S\+F\+UL} & Successful operation. \\
\hline
{\em R\+T\+E\+M\+S\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+ID} & Block device node does not exist. \\
\hline
{\em R\+T\+E\+M\+S\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+N\+O\+DE} & File system node is not a block device. \\
\hline
{\em R\+T\+E\+M\+S\+\_\+\+N\+O\+T\+\_\+\+I\+M\+P\+L\+E\+M\+E\+N\+T\+ED} & Block device implementation is incomplete. \\
\hline
{\em R\+T\+E\+M\+S\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+N\+U\+M\+B\+ER} & Block begin or block count is invalid. \\
\hline
{\em R\+T\+E\+M\+S\+\_\+\+N\+O\+\_\+\+M\+E\+M\+O\+RY} & Not enough memory. \\
\hline
{\em R\+T\+E\+M\+S\+\_\+\+U\+N\+S\+A\+T\+I\+S\+F\+I\+ED} & Cannot create generic device node.\\
\hline
\end{DoxyRetVals}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{group__rtems__blkdev_gae2fe7e8c05fa9db0fa7c0ec4e8e4967d}{rtems\+\_\+blkdev\+\_\+create()}} and \mbox{\hyperlink{group__rtems__bdbuf_ga649b3b4fb368921f579a0204552a7a60}{rtems\+\_\+bdbuf\+\_\+set\+\_\+block\+\_\+size()}}. 
\end{DoxySeeAlso}
\mbox{\Hypertarget{group__rtems__blkdev_gab555c151c08cc5ec60ccea5d24052d23}\label{group__rtems__blkdev_gab555c151c08cc5ec60ccea5d24052d23}} 
\index{Block Device Management@{Block Device Management}!rtems\_blkdev\_ioctl@{rtems\_blkdev\_ioctl}}
\index{rtems\_blkdev\_ioctl@{rtems\_blkdev\_ioctl}!Block Device Management@{Block Device Management}}
\subsubsection{\texorpdfstring{rtems\_blkdev\_ioctl()}{rtems\_blkdev\_ioctl()}}
{\footnotesize\ttfamily int rtems\+\_\+blkdev\+\_\+ioctl (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structrtems__disk__device}{rtems\+\_\+disk\+\_\+device}} $\ast$}]{dd,  }\item[{uint32\+\_\+t}]{req,  }\item[{void $\ast$}]{argp }\end{DoxyParamCaption})}



Common \mbox{\hyperlink{structIO}{IO}} control primitive. 

Use this in all block devices to handle the common set of \mbox{\hyperlink{structIO}{IO}} control requests. 