\hypertarget{rtems-rfs-link_8c}{}\section{cpukit/libfs/src/rfs/rtems-\/rfs-\/link.c File Reference}
\label{rtems-rfs-link_8c}\index{cpukit/libfs/src/rfs/rtems-\/rfs-\/link.c@{cpukit/libfs/src/rfs/rtems-\/rfs-\/link.c}}


R\+T\+E\+MS File Systems Link Routines.  


{\ttfamily \#include $<$inttypes.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$rtems/rfs/rtems-\/rfs-\/block.\+h$>$}\newline
{\ttfamily \#include $<$rtems/rfs/rtems-\/rfs-\/buffer.\+h$>$}\newline
{\ttfamily \#include $<$rtems/rfs/rtems-\/rfs-\/file-\/system.\+h$>$}\newline
{\ttfamily \#include $<$rtems/rfs/rtems-\/rfs-\/trace.\+h$>$}\newline
{\ttfamily \#include $<$rtems/rfs/rtems-\/rfs-\/dir.\+h$>$}\newline
{\ttfamily \#include $<$rtems/rfs/rtems-\/rfs-\/dir-\/hash.\+h$>$}\newline
{\ttfamily \#include $<$rtems/rfs/rtems-\/rfs-\/link.\+h$>$}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{rtems-rfs-link_8c_a21b4f5283c14d67044a3eb7710059e80}{rtems\+\_\+rfs\+\_\+link}} (\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$fs, const char $\ast$name, int length, \mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}} parent, \mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}} target, bool link\+\_\+dir)
\item 
int \mbox{\hyperlink{rtems-rfs-link_8c_a688547629f6f92228919b7938a1cbfb4}{rtems\+\_\+rfs\+\_\+unlink}} (\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$fs, \mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}} parent, \mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}} target, uint32\+\_\+t doff, \mbox{\hyperlink{rtems-rfs-link_8h_aa5069a5066794404a5afb31ac6067cd0}{rtems\+\_\+rfs\+\_\+unlink\+\_\+dir}} dir\+\_\+mode)
\item 
int \mbox{\hyperlink{rtems-rfs-link_8c_ad174cb40689aacab6621b9df946bc3f3}{rtems\+\_\+rfs\+\_\+symlink}} (\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$fs, const char $\ast$name, int length, const char $\ast$\mbox{\hyperlink{link_8c_a8c94afd0b7e5bb4ce95fefd964241f7f}{link}}, int link\+\_\+length, uid\+\_\+t uid, gid\+\_\+t gid, \mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}} parent)
\item 
int \mbox{\hyperlink{rtems-rfs-link_8c_a41b4368e951ea5b33913fd5e1a7d2c80}{rtems\+\_\+rfs\+\_\+symlink\+\_\+read}} (\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$fs, \mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}} \mbox{\hyperlink{link_8c_a8c94afd0b7e5bb4ce95fefd964241f7f}{link}}, char $\ast$path, size\+\_\+t \mbox{\hyperlink{sun4u_2tte_8h_a245260f6f74972558f61b85227df5aae}{size}}, size\+\_\+t $\ast$length)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
R\+T\+E\+MS File Systems Link Routines. 

These functions manage links. A link is the addition of a directory entry in a parent directory and incrementing the links count in the inode. 

\subsection{Function Documentation}
\mbox{\Hypertarget{rtems-rfs-link_8c_a21b4f5283c14d67044a3eb7710059e80}\label{rtems-rfs-link_8c_a21b4f5283c14d67044a3eb7710059e80}} 
\index{rtems-\/rfs-\/link.c@{rtems-\/rfs-\/link.c}!rtems\_rfs\_link@{rtems\_rfs\_link}}
\index{rtems\_rfs\_link@{rtems\_rfs\_link}!rtems-\/rfs-\/link.c@{rtems-\/rfs-\/link.c}}
\subsubsection{\texorpdfstring{rtems\_rfs\_link()}{rtems\_rfs\_link()}}
{\footnotesize\ttfamily int rtems\+\_\+rfs\+\_\+link (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$}]{fs,  }\item[{const char $\ast$}]{name,  }\item[{int}]{length,  }\item[{\mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}}}]{parent,  }\item[{\mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}}}]{target,  }\item[{bool}]{link\+\_\+dir }\end{DoxyParamCaption})}

Create a link. Do not link directories unless renaming or you will create loops in the file system.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em fs} & is the file system. \\
\hline
\mbox{\texttt{ in}}  & {\em name} & is a pointer to the name of the link. \\
\hline
\mbox{\texttt{ in}}  & {\em length} & is the length of the name. \\
\hline
\mbox{\texttt{ in}}  & {\em parent} & is the inode number of the parent directory. \\
\hline
\mbox{\texttt{ in}}  & {\em target} & is the inode of the target. \\
\hline
\mbox{\texttt{ in}}  & {\em link\+\_\+dir} & If true directories can be linked. Useful when renaming.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & Successful operation. \\
\hline
{\em error\+\_\+code} & An error occurred. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{rtems-rfs-link_8c_ad174cb40689aacab6621b9df946bc3f3}\label{rtems-rfs-link_8c_ad174cb40689aacab6621b9df946bc3f3}} 
\index{rtems-\/rfs-\/link.c@{rtems-\/rfs-\/link.c}!rtems\_rfs\_symlink@{rtems\_rfs\_symlink}}
\index{rtems\_rfs\_symlink@{rtems\_rfs\_symlink}!rtems-\/rfs-\/link.c@{rtems-\/rfs-\/link.c}}
\subsubsection{\texorpdfstring{rtems\_rfs\_symlink()}{rtems\_rfs\_symlink()}}
{\footnotesize\ttfamily int rtems\+\_\+rfs\+\_\+symlink (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$}]{fs,  }\item[{const char $\ast$}]{name,  }\item[{int}]{length,  }\item[{const char $\ast$}]{link,  }\item[{int}]{link\+\_\+length,  }\item[{uid\+\_\+t}]{uid,  }\item[{gid\+\_\+t}]{gid,  }\item[{\mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}}}]{parent }\end{DoxyParamCaption})}

Symbolic link is an inode that has a path attached.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em fs} & is the file system data. \\
\hline
\mbox{\texttt{ in}}  & {\em name} & is a pointer to the name of the node. \\
\hline
\mbox{\texttt{ in}}  & {\em length} & is the length of the name of the node. \\
\hline
\mbox{\texttt{ in}}  & {\em link} & is a pointer to the link path attached to the symlink inode. \\
\hline
\mbox{\texttt{ in}}  & {\em link\+\_\+length} & is the length of the link path. \\
\hline
\mbox{\texttt{ in}}  & {\em parent} & is the parent inode number.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & Successful operation. \\
\hline
{\em error\+\_\+code} & An error occurred. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{rtems-rfs-link_8c_a41b4368e951ea5b33913fd5e1a7d2c80}\label{rtems-rfs-link_8c_a41b4368e951ea5b33913fd5e1a7d2c80}} 
\index{rtems-\/rfs-\/link.c@{rtems-\/rfs-\/link.c}!rtems\_rfs\_symlink\_read@{rtems\_rfs\_symlink\_read}}
\index{rtems\_rfs\_symlink\_read@{rtems\_rfs\_symlink\_read}!rtems-\/rfs-\/link.c@{rtems-\/rfs-\/link.c}}
\subsubsection{\texorpdfstring{rtems\_rfs\_symlink\_read()}{rtems\_rfs\_symlink\_read()}}
{\footnotesize\ttfamily int rtems\+\_\+rfs\+\_\+symlink\+\_\+read (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$}]{fs,  }\item[{\mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}}}]{link,  }\item[{char $\ast$}]{path,  }\item[{size\+\_\+t}]{size,  }\item[{size\+\_\+t $\ast$}]{length }\end{DoxyParamCaption})}

Read a symbolic link into the provided buffer returning the link of link name.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em fs} & is the file system data. \\
\hline
\mbox{\texttt{ in}}  & {\em link} & is the link inode number to read. \\
\hline
\mbox{\texttt{ in}}  & {\em path} & is a pointer to the buffer to write the link path into. \\
\hline
\mbox{\texttt{ in}}  & {\em size} & is the size of the buffer. \\
\hline
\mbox{\texttt{ out}}  & {\em length} & will contain the length of the link path.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & Successful operation. \\
\hline
{\em error\+\_\+code} & An error occurred. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{rtems-rfs-link_8c_a688547629f6f92228919b7938a1cbfb4}\label{rtems-rfs-link_8c_a688547629f6f92228919b7938a1cbfb4}} 
\index{rtems-\/rfs-\/link.c@{rtems-\/rfs-\/link.c}!rtems\_rfs\_unlink@{rtems\_rfs\_unlink}}
\index{rtems\_rfs\_unlink@{rtems\_rfs\_unlink}!rtems-\/rfs-\/link.c@{rtems-\/rfs-\/link.c}}
\subsubsection{\texorpdfstring{rtems\_rfs\_unlink()}{rtems\_rfs\_unlink()}}
{\footnotesize\ttfamily int rtems\+\_\+rfs\+\_\+unlink (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$}]{fs,  }\item[{\mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}}}]{parent,  }\item[{\mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}}}]{target,  }\item[{uint32\+\_\+t}]{doff,  }\item[{\mbox{\hyperlink{rtems-rfs-link_8h_aa5069a5066794404a5afb31ac6067cd0}{rtems\+\_\+rfs\+\_\+unlink\+\_\+dir}}}]{dir\+\_\+mode }\end{DoxyParamCaption})}

Unlink the node from the parent directory. A directory offset for the target entry is required because links cause a number of inode numbers to appear in a single directory so scanning does not work.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em fs} & is the file system. \\
\hline
\mbox{\texttt{ in}}  & {\em parent} & is the inode number of the parent directory. \\
\hline
\mbox{\texttt{ in}}  & {\em target} & is the inode of the target. \\
\hline
\mbox{\texttt{ in}}  & {\em doff} & is the parent directory entry offset for the target entry. \\
\hline
\mbox{\texttt{ in}}  & {\em dir\+\_\+mode} & is the directory unlink mode.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & Successful operation. \\
\hline
{\em error\+\_\+code} & An error occurred. \\
\hline
\end{DoxyRetVals}
