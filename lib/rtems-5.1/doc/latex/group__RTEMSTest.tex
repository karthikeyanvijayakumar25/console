\hypertarget{group__RTEMSTest}{}\section{Test Support}
\label{group__RTEMSTest}\index{Test Support@{Test Support}}


Test support functions.  


\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structrtems__test__parallel__context}{rtems\+\_\+test\+\_\+parallel\+\_\+context}}
\begin{DoxyCompactList}\small\item\em Internal context for parallel job execution. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structrtems__test__parallel__job}{rtems\+\_\+test\+\_\+parallel\+\_\+job}}
\begin{DoxyCompactList}\small\item\em Basic parallel job description. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group__RTEMSTest_gab0ffa504e738f7949a88fe8fd1ecf3cd}\label{group__RTEMSTest_gab0ffa504e738f7949a88fe8fd1ecf3cd}} 
\#define \mbox{\hyperlink{group__RTEMSTest_gab0ffa504e738f7949a88fe8fd1ecf3cd}{R\+T\+E\+M\+S\+\_\+\+T\+E\+S\+T\+\_\+\+I\+N\+I\+T\+I\+A\+L\+\_\+\+E\+X\+T\+E\+N\+S\+I\+ON}}~\{ \mbox{\hyperlink{bestcomm__api_8h_a872bb74de61c3689ccd5b41873fce42c}{N\+U\+LL}}, \mbox{\hyperlink{bestcomm__api_8h_a872bb74de61c3689ccd5b41873fce42c}{N\+U\+LL}}, \mbox{\hyperlink{bestcomm__api_8h_a872bb74de61c3689ccd5b41873fce42c}{N\+U\+LL}}, \mbox{\hyperlink{bestcomm__api_8h_a872bb74de61c3689ccd5b41873fce42c}{N\+U\+LL}}, \mbox{\hyperlink{bestcomm__api_8h_a872bb74de61c3689ccd5b41873fce42c}{N\+U\+LL}}, \mbox{\hyperlink{bestcomm__api_8h_a872bb74de61c3689ccd5b41873fce42c}{N\+U\+LL}}, \mbox{\hyperlink{bestcomm__api_8h_a872bb74de61c3689ccd5b41873fce42c}{N\+U\+LL}}, \mbox{\hyperlink{group__RTEMSTest_ga79fcd10b018b0b8499b54a25d88f990b}{rtems\+\_\+test\+\_\+fatal\+\_\+extension}} \}
\begin{DoxyCompactList}\small\item\em Initial extension for tests. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__RTEMSTest_gae1855ac308dcc3e281ce1c0a9bacb2bb}\label{group__RTEMSTest_gae1855ac308dcc3e281ce1c0a9bacb2bb}} 
\#define {\bfseries T\+E\+S\+T\+\_\+\+S\+T\+A\+TE}~R\+T\+E\+M\+S\+\_\+\+T\+E\+S\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+P\+A\+SS
\item 
\mbox{\Hypertarget{group__RTEMSTest_ga60fc0e719edd2c5fd4af87b577b8b5bc}\label{group__RTEMSTest_ga60fc0e719edd2c5fd4af87b577b8b5bc}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+T\+E\+S\+T\+\_\+\+P\+A\+R\+A\+L\+L\+E\+L\+\_\+\+P\+R\+O\+C\+E\+S\+S\+O\+R\+\_\+\+M\+AX}~32
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group__RTEMSTest_gaa667310622867cf1fd814cdf60d84591}\label{group__RTEMSTest_gaa667310622867cf1fd814cdf60d84591}} 
typedef struct \mbox{\hyperlink{structrtems__test__parallel__job}{rtems\+\_\+test\+\_\+parallel\+\_\+job}} {\bfseries rtems\+\_\+test\+\_\+parallel\+\_\+job}
\item 
typedef void($\ast$ \mbox{\hyperlink{group__RTEMSTest_ga89f4019d001f65865999e823e35dfdcb}{rtems\+\_\+test\+\_\+parallel\+\_\+worker\+\_\+setup}}) (\mbox{\hyperlink{structrtems__test__parallel__context}{rtems\+\_\+test\+\_\+parallel\+\_\+context}} $\ast$ctx, size\+\_\+t worker\+\_\+index, \mbox{\hyperlink{group__ClassicTasks_gab20892b814dced7dd4e5b9bf42becd57}{rtems\+\_\+id}} worker\+\_\+id)
\begin{DoxyCompactList}\small\item\em Worker task setup handler. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group__RTEMSTest_gab272ab809e3df25459e5cb8a66762e52}\label{group__RTEMSTest_gab272ab809e3df25459e5cb8a66762e52}} 
enum \mbox{\hyperlink{group__RTEMSTest_gab272ab809e3df25459e5cb8a66762e52}{R\+T\+E\+M\+S\+\_\+\+T\+E\+S\+T\+\_\+\+S\+T\+A\+TE}} \{ \newline
{\bfseries R\+T\+E\+M\+S\+\_\+\+T\+E\+S\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+P\+A\+SS}, 
{\bfseries R\+T\+E\+M\+S\+\_\+\+T\+E\+S\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+F\+A\+IL}, 
{\bfseries R\+T\+E\+M\+S\+\_\+\+T\+E\+S\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+U\+S\+E\+R\+\_\+\+I\+N\+P\+UT}, 
{\bfseries R\+T\+E\+M\+S\+\_\+\+T\+E\+S\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+I\+N\+D\+E\+T\+E\+R\+M\+I\+N\+A\+TE}, 
\newline
{\bfseries R\+T\+E\+M\+S\+\_\+\+T\+E\+S\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+B\+E\+N\+C\+H\+M\+A\+RK}
 \}
\begin{DoxyCompactList}\small\item\em Test states. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group__RTEMSTest_ga79fcd10b018b0b8499b54a25d88f990b}\label{group__RTEMSTest_ga79fcd10b018b0b8499b54a25d88f990b}} 
void \mbox{\hyperlink{group__RTEMSTest_ga79fcd10b018b0b8499b54a25d88f990b}{rtems\+\_\+test\+\_\+fatal\+\_\+extension}} (\mbox{\hyperlink{group__RTEMSScoreIntErr_ga878b4de77df7d0b83d19609d4de42c26}{rtems\+\_\+fatal\+\_\+source}} source, bool always\+\_\+set\+\_\+to\+\_\+false, rtems\+\_\+fatal\+\_\+code \mbox{\hyperlink{structcode}{code}})
\begin{DoxyCompactList}\small\item\em Fatal extension for tests. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__RTEMSTest_gaf651d0e7e25a5761afa106ca407b9b68}{rtems\+\_\+test\+\_\+begin}} (const char $\ast$name, const \mbox{\hyperlink{group__RTEMSTest_gab272ab809e3df25459e5cb8a66762e52}{R\+T\+E\+M\+S\+\_\+\+T\+E\+S\+T\+\_\+\+S\+T\+A\+TE}} state)
\begin{DoxyCompactList}\small\item\em Prints a begin of test message using printf(). \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__RTEMSTest_gafeae3b6d6cf174a0e91d6347be9cd211}{rtems\+\_\+test\+\_\+end}} (const char $\ast$name)
\begin{DoxyCompactList}\small\item\em Prints an end of test message using printf(). \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__RTEMSTest_ga9ff57a71a4d38d69d121a2d69a15359a}\label{group__RTEMSTest_ga9ff57a71a4d38d69d121a2d69a15359a}} 
void \mbox{\hyperlink{group__RTEMSTest_ga9ff57a71a4d38d69d121a2d69a15359a}{rtems\+\_\+test\+\_\+exit}} (int status) \mbox{\hyperlink{group__RTEMSScoreBaseDefs_gaa2f0ed67aa174f684bb31b7e8bdb386f}{R\+T\+E\+M\+S\+\_\+\+N\+O\+\_\+\+R\+E\+T\+U\+RN}}
\begin{DoxyCompactList}\small\item\em Exit the test without calling exit() since it closes stdin, etc and pulls in stdio code. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__RTEMSTest_ga734557e139bda5d59546fe3bc28fbfa7}{rtems\+\_\+test\+\_\+printf}} (const char $\ast$\mbox{\hyperlink{structformat}{format}},...) \mbox{\hyperlink{group__RTEMSScoreBaseDefs_gac1811143c580ed4898c9eae63d5c5b8e}{R\+T\+E\+M\+S\+\_\+\+P\+R\+I\+N\+T\+F\+L\+I\+KE}}(1
\begin{DoxyCompactList}\small\item\em Prints via the R\+T\+E\+MS printer. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group__RTEMSTest_gaedc964c27c6e146a3606bb0ab2784d97}{rtems\+\_\+test\+\_\+parallel}} (\mbox{\hyperlink{structrtems__test__parallel__context}{rtems\+\_\+test\+\_\+parallel\+\_\+context}} $\ast$ctx, \mbox{\hyperlink{group__RTEMSTest_ga89f4019d001f65865999e823e35dfdcb}{rtems\+\_\+test\+\_\+parallel\+\_\+worker\+\_\+setup}} worker\+\_\+setup, const \mbox{\hyperlink{structrtems__test__parallel__job}{rtems\+\_\+test\+\_\+parallel\+\_\+job}} $\ast$jobs, size\+\_\+t job\+\_\+count)
\begin{DoxyCompactList}\small\item\em Runs a bunch of jobs in parallel on all processors of the system. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group__RTEMSTest_ga3226bd2aac6e7ea341e160f66a976a65}{rtems\+\_\+test\+\_\+busy\+\_\+cpu\+\_\+usage}} (time\+\_\+t seconds, long nanoseconds)
\begin{DoxyCompactList}\small\item\em Performs a busy loop for the specified seconds and nanoseconds based on the C\+PU usage of the executing thread. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group__RTEMSTest_ga4ef73d9b32877ff064b30f151e0d2098}{rtems\+\_\+test\+\_\+busy}} (uint\+\_\+fast32\+\_\+t count)
\begin{DoxyCompactList}\small\item\em Performs a busy loop with the specified iteration count. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__RTEMSTest_ga246dbecb60b96380488a2b99e722fed3}\label{group__RTEMSTest_ga246dbecb60b96380488a2b99e722fed3}} 
uint\+\_\+fast32\+\_\+t \mbox{\hyperlink{group__RTEMSTest_ga246dbecb60b96380488a2b99e722fed3}{rtems\+\_\+test\+\_\+get\+\_\+one\+\_\+tick\+\_\+busy\+\_\+count}} (void)
\begin{DoxyCompactList}\small\item\em Returns a count value for \mbox{\hyperlink{group__RTEMSTest_ga4ef73d9b32877ff064b30f151e0d2098}{rtems\+\_\+test\+\_\+busy()}} which yields roughly a duration of one clock tick. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group__RTEMSTest_ga65ef8af5fce3a12e0ae88a4313008fc0}\label{group__RTEMSTest_ga65ef8af5fce3a12e0ae88a4313008fc0}} 
const char \mbox{\hyperlink{group__RTEMSTest_ga65ef8af5fce3a12e0ae88a4313008fc0}{rtems\+\_\+test\+\_\+name}} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em Each test must define a test name string. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__RTEMSTest_ga58d3560fdfc29e8d20723404c2c062fb}\label{group__RTEMSTest_ga58d3560fdfc29e8d20723404c2c062fb}} 
\mbox{\hyperlink{structrtems__printer}{rtems\+\_\+printer}} \mbox{\hyperlink{group__RTEMSTest_ga58d3560fdfc29e8d20723404c2c062fb}{rtems\+\_\+test\+\_\+printer}}
\begin{DoxyCompactList}\small\item\em Each test must define a printer. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Test support functions. 



\subsection{Typedef Documentation}
\mbox{\Hypertarget{group__RTEMSTest_ga89f4019d001f65865999e823e35dfdcb}\label{group__RTEMSTest_ga89f4019d001f65865999e823e35dfdcb}} 
\index{Test Support@{Test Support}!rtems\_test\_parallel\_worker\_setup@{rtems\_test\_parallel\_worker\_setup}}
\index{rtems\_test\_parallel\_worker\_setup@{rtems\_test\_parallel\_worker\_setup}!Test Support@{Test Support}}
\subsubsection{\texorpdfstring{rtems\_test\_parallel\_worker\_setup}{rtems\_test\_parallel\_worker\_setup}}
{\footnotesize\ttfamily typedef void($\ast$ rtems\+\_\+test\+\_\+parallel\+\_\+worker\+\_\+setup) (\mbox{\hyperlink{structrtems__test__parallel__context}{rtems\+\_\+test\+\_\+parallel\+\_\+context}} $\ast$ctx, size\+\_\+t worker\+\_\+index, \mbox{\hyperlink{group__ClassicTasks_gab20892b814dced7dd4e5b9bf42becd57}{rtems\+\_\+id}} worker\+\_\+id)}



Worker task setup handler. 

Called during \mbox{\hyperlink{group__RTEMSTest_gaedc964c27c6e146a3606bb0ab2784d97}{rtems\+\_\+test\+\_\+parallel()}} to optionally setup a worker task before it is started.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ctx} & The parallel context. \\
\hline
\mbox{\texttt{ in}}  & {\em worker\+\_\+index} & The worker index. \\
\hline
\mbox{\texttt{ in}}  & {\em worker\+\_\+id} & The worker task identifier. \\
\hline
\end{DoxyParams}


\subsection{Function Documentation}
\mbox{\Hypertarget{group__RTEMSTest_gaf651d0e7e25a5761afa106ca407b9b68}\label{group__RTEMSTest_gaf651d0e7e25a5761afa106ca407b9b68}} 
\index{Test Support@{Test Support}!rtems\_test\_begin@{rtems\_test\_begin}}
\index{rtems\_test\_begin@{rtems\_test\_begin}!Test Support@{Test Support}}
\subsubsection{\texorpdfstring{rtems\_test\_begin()}{rtems\_test\_begin()}}
{\footnotesize\ttfamily int rtems\+\_\+test\+\_\+begin (\begin{DoxyParamCaption}\item[{const char $\ast$}]{name,  }\item[{const \mbox{\hyperlink{group__RTEMSTest_gab272ab809e3df25459e5cb8a66762e52}{R\+T\+E\+M\+S\+\_\+\+T\+E\+S\+T\+\_\+\+S\+T\+A\+TE}}}]{state }\end{DoxyParamCaption})}



Prints a begin of test message using printf(). 

\begin{DoxyReturn}{Returns}
As specified by printf(). 
\end{DoxyReturn}
\mbox{\Hypertarget{group__RTEMSTest_ga4ef73d9b32877ff064b30f151e0d2098}\label{group__RTEMSTest_ga4ef73d9b32877ff064b30f151e0d2098}} 
\index{Test Support@{Test Support}!rtems\_test\_busy@{rtems\_test\_busy}}
\index{rtems\_test\_busy@{rtems\_test\_busy}!Test Support@{Test Support}}
\subsubsection{\texorpdfstring{rtems\_test\_busy()}{rtems\_test\_busy()}}
{\footnotesize\ttfamily void rtems\+\_\+test\+\_\+busy (\begin{DoxyParamCaption}\item[{uint\+\_\+fast32\+\_\+t}]{count }\end{DoxyParamCaption})}



Performs a busy loop with the specified iteration count. 

This function is optimized to not perform memory accesses and should have a small jitter.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em count} & The iteration count. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{group__RTEMSTest_ga3226bd2aac6e7ea341e160f66a976a65}\label{group__RTEMSTest_ga3226bd2aac6e7ea341e160f66a976a65}} 
\index{Test Support@{Test Support}!rtems\_test\_busy\_cpu\_usage@{rtems\_test\_busy\_cpu\_usage}}
\index{rtems\_test\_busy\_cpu\_usage@{rtems\_test\_busy\_cpu\_usage}!Test Support@{Test Support}}
\subsubsection{\texorpdfstring{rtems\_test\_busy\_cpu\_usage()}{rtems\_test\_busy\_cpu\_usage()}}
{\footnotesize\ttfamily void rtems\+\_\+test\+\_\+busy\+\_\+cpu\+\_\+usage (\begin{DoxyParamCaption}\item[{time\+\_\+t}]{seconds,  }\item[{long}]{nanoseconds }\end{DoxyParamCaption})}



Performs a busy loop for the specified seconds and nanoseconds based on the C\+PU usage of the executing thread. 

This function continuously reads the C\+PU usage of the executing thread. This operation may lead to a scheduler instance lock contention in S\+MP configurations.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em seconds} & The busy seconds. \\
\hline
\mbox{\texttt{ in}}  & {\em nanoseconds} & The busy nanoseconds. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{group__RTEMSTest_gafeae3b6d6cf174a0e91d6347be9cd211}\label{group__RTEMSTest_gafeae3b6d6cf174a0e91d6347be9cd211}} 
\index{Test Support@{Test Support}!rtems\_test\_end@{rtems\_test\_end}}
\index{rtems\_test\_end@{rtems\_test\_end}!Test Support@{Test Support}}
\subsubsection{\texorpdfstring{rtems\_test\_end()}{rtems\_test\_end()}}
{\footnotesize\ttfamily int rtems\+\_\+test\+\_\+end (\begin{DoxyParamCaption}\item[{const char $\ast$}]{name }\end{DoxyParamCaption})}



Prints an end of test message using printf(). 

\begin{DoxyReturn}{Returns}
As specified by printf(). 
\end{DoxyReturn}
\mbox{\Hypertarget{group__RTEMSTest_gaedc964c27c6e146a3606bb0ab2784d97}\label{group__RTEMSTest_gaedc964c27c6e146a3606bb0ab2784d97}} 
\index{Test Support@{Test Support}!rtems\_test\_parallel@{rtems\_test\_parallel}}
\index{rtems\_test\_parallel@{rtems\_test\_parallel}!Test Support@{Test Support}}
\subsubsection{\texorpdfstring{rtems\_test\_parallel()}{rtems\_test\_parallel()}}
{\footnotesize\ttfamily void rtems\+\_\+test\+\_\+parallel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structrtems__test__parallel__context}{rtems\+\_\+test\+\_\+parallel\+\_\+context}} $\ast$}]{ctx,  }\item[{\mbox{\hyperlink{group__RTEMSTest_ga89f4019d001f65865999e823e35dfdcb}{rtems\+\_\+test\+\_\+parallel\+\_\+worker\+\_\+setup}}}]{worker\+\_\+setup,  }\item[{const \mbox{\hyperlink{structrtems__test__parallel__job}{rtems\+\_\+test\+\_\+parallel\+\_\+job}} $\ast$}]{jobs,  }\item[{size\+\_\+t}]{job\+\_\+count }\end{DoxyParamCaption})}



Runs a bunch of jobs in parallel on all processors of the system. 

The worker tasks inherit the priority of the executing task.

There are S\+MP barriers before and after the job body.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ctx} & The parallel context. \\
\hline
\mbox{\texttt{ in}}  & {\em worker\+\_\+setup} & Optional handler to setup a worker task before it is started. \\
\hline
\mbox{\texttt{ in}}  & {\em jobs} & The table of jobs. \\
\hline
\mbox{\texttt{ in}}  & {\em job\+\_\+count} & The count of jobs in the job table. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{group__RTEMSTest_ga734557e139bda5d59546fe3bc28fbfa7}\label{group__RTEMSTest_ga734557e139bda5d59546fe3bc28fbfa7}} 
\index{Test Support@{Test Support}!rtems\_test\_printf@{rtems\_test\_printf}}
\index{rtems\_test\_printf@{rtems\_test\_printf}!Test Support@{Test Support}}
\subsubsection{\texorpdfstring{rtems\_test\_printf()}{rtems\_test\_printf()}}
{\footnotesize\ttfamily int rtems\+\_\+test\+\_\+printf (\begin{DoxyParamCaption}\item[{const char $\ast$}]{format,  }\item[{}]{... }\end{DoxyParamCaption})}



Prints via the R\+T\+E\+MS printer. 

\begin{DoxyReturn}{Returns}
As specified by printf(). 
\end{DoxyReturn}
