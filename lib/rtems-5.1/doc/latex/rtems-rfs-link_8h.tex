\hypertarget{rtems-rfs-link_8h}{}\section{cpukit/include/rtems/rfs/rtems-\/rfs-\/link.h File Reference}
\label{rtems-rfs-link_8h}\index{cpukit/include/rtems/rfs/rtems-\/rfs-\/link.h@{cpukit/include/rtems/rfs/rtems-\/rfs-\/link.h}}


R\+T\+E\+MS File System Link Support.  


{\ttfamily \#include $<$dirent.\+h$>$}\newline
{\ttfamily \#include $<$rtems/rfs/rtems-\/rfs-\/file-\/system.\+h$>$}\newline
{\ttfamily \#include $<$rtems/rfs/rtems-\/rfs-\/inode.\+h$>$}\newline
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef enum \mbox{\hyperlink{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29}{rtems\+\_\+rfs\+\_\+unlink\+\_\+dir\+\_\+e}} \mbox{\hyperlink{rtems-rfs-link_8h_aa5069a5066794404a5afb31ac6067cd0}{rtems\+\_\+rfs\+\_\+unlink\+\_\+dir}}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29}{rtems\+\_\+rfs\+\_\+unlink\+\_\+dir\+\_\+e}} \{ \mbox{\hyperlink{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29a47a94ddacd547226c095b31f98863493}{rtems\+\_\+rfs\+\_\+unlink\+\_\+dir\+\_\+denied}}, 
\mbox{\hyperlink{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29a85a813f2d964e8b1c11951e518917962}{rtems\+\_\+rfs\+\_\+unlink\+\_\+dir\+\_\+if\+\_\+empty}}, 
\mbox{\hyperlink{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29af0d29bbe08718a885c872b098384c3dc}{rtems\+\_\+rfs\+\_\+unlink\+\_\+dir\+\_\+allowed}}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{rtems-rfs-link_8h_a21b4f5283c14d67044a3eb7710059e80}{rtems\+\_\+rfs\+\_\+link}} (\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$fs, const char $\ast$name, int length, \mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}} parent, \mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}} target, bool link\+\_\+dir)
\item 
int \mbox{\hyperlink{rtems-rfs-link_8h_a688547629f6f92228919b7938a1cbfb4}{rtems\+\_\+rfs\+\_\+unlink}} (\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$fs, \mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}} parent, \mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}} target, uint32\+\_\+t doff, \mbox{\hyperlink{rtems-rfs-link_8h_aa5069a5066794404a5afb31ac6067cd0}{rtems\+\_\+rfs\+\_\+unlink\+\_\+dir}} dir\+\_\+mode)
\item 
int \mbox{\hyperlink{rtems-rfs-link_8h_ad174cb40689aacab6621b9df946bc3f3}{rtems\+\_\+rfs\+\_\+symlink}} (\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$fs, const char $\ast$name, int length, const char $\ast$\mbox{\hyperlink{link_8c_a8c94afd0b7e5bb4ce95fefd964241f7f}{link}}, int link\+\_\+length, uid\+\_\+t uid, gid\+\_\+t gid, \mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}} parent)
\item 
int \mbox{\hyperlink{rtems-rfs-link_8h_a41b4368e951ea5b33913fd5e1a7d2c80}{rtems\+\_\+rfs\+\_\+symlink\+\_\+read}} (\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$fs, \mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}} \mbox{\hyperlink{link_8c_a8c94afd0b7e5bb4ce95fefd964241f7f}{link}}, char $\ast$path, size\+\_\+t \mbox{\hyperlink{sun4u_2tte_8h_a245260f6f74972558f61b85227df5aae}{size}}, size\+\_\+t $\ast$length)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
R\+T\+E\+MS File System Link Support. 

R\+T\+E\+MS File System Link Support

This file provides the link support functions. 

\subsection{Typedef Documentation}
\mbox{\Hypertarget{rtems-rfs-link_8h_aa5069a5066794404a5afb31ac6067cd0}\label{rtems-rfs-link_8h_aa5069a5066794404a5afb31ac6067cd0}} 
\index{rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}!rtems\_rfs\_unlink\_dir@{rtems\_rfs\_unlink\_dir}}
\index{rtems\_rfs\_unlink\_dir@{rtems\_rfs\_unlink\_dir}!rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}}
\subsubsection{\texorpdfstring{rtems\_rfs\_unlink\_dir}{rtems\_rfs\_unlink\_dir}}
{\footnotesize\ttfamily typedef enum \mbox{\hyperlink{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29}{rtems\+\_\+rfs\+\_\+unlink\+\_\+dir\+\_\+e}}  \mbox{\hyperlink{rtems-rfs-link_8h_aa5069a5066794404a5afb31ac6067cd0}{rtems\+\_\+rfs\+\_\+unlink\+\_\+dir}}}

Directory unlink modes. 

\subsection{Enumeration Type Documentation}
\mbox{\Hypertarget{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29}\label{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29}} 
\index{rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}!rtems\_rfs\_unlink\_dir\_e@{rtems\_rfs\_unlink\_dir\_e}}
\index{rtems\_rfs\_unlink\_dir\_e@{rtems\_rfs\_unlink\_dir\_e}!rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}}
\subsubsection{\texorpdfstring{rtems\_rfs\_unlink\_dir\_e}{rtems\_rfs\_unlink\_dir\_e}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29}{rtems\+\_\+rfs\+\_\+unlink\+\_\+dir\+\_\+e}}}

Directory unlink modes. \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{rtems\_rfs\_unlink\_dir\_denied@{rtems\_rfs\_unlink\_dir\_denied}!rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}}\index{rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}!rtems\_rfs\_unlink\_dir\_denied@{rtems\_rfs\_unlink\_dir\_denied}}}\mbox{\Hypertarget{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29a47a94ddacd547226c095b31f98863493}\label{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29a47a94ddacd547226c095b31f98863493}} 
rtems\+\_\+rfs\+\_\+unlink\+\_\+dir\+\_\+denied&Not allowed to unlink a directory. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{rtems\_rfs\_unlink\_dir\_if\_empty@{rtems\_rfs\_unlink\_dir\_if\_empty}!rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}}\index{rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}!rtems\_rfs\_unlink\_dir\_if\_empty@{rtems\_rfs\_unlink\_dir\_if\_empty}}}\mbox{\Hypertarget{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29a85a813f2d964e8b1c11951e518917962}\label{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29a85a813f2d964e8b1c11951e518917962}} 
rtems\+\_\+rfs\+\_\+unlink\+\_\+dir\+\_\+if\+\_\+empty&Unlink if the directory is empty. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{rtems\_rfs\_unlink\_dir\_allowed@{rtems\_rfs\_unlink\_dir\_allowed}!rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}}\index{rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}!rtems\_rfs\_unlink\_dir\_allowed@{rtems\_rfs\_unlink\_dir\_allowed}}}\mbox{\Hypertarget{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29af0d29bbe08718a885c872b098384c3dc}\label{rtems-rfs-link_8h_a2ba2820fed9440f306c38dbb35c14a29af0d29bbe08718a885c872b098384c3dc}} 
rtems\+\_\+rfs\+\_\+unlink\+\_\+dir\+\_\+allowed&Unlinking of directories is allowed. \\
\hline

\end{DoxyEnumFields}


\subsection{Function Documentation}
\mbox{\Hypertarget{rtems-rfs-link_8h_a21b4f5283c14d67044a3eb7710059e80}\label{rtems-rfs-link_8h_a21b4f5283c14d67044a3eb7710059e80}} 
\index{rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}!rtems\_rfs\_link@{rtems\_rfs\_link}}
\index{rtems\_rfs\_link@{rtems\_rfs\_link}!rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}}
\subsubsection{\texorpdfstring{rtems\_rfs\_link()}{rtems\_rfs\_link()}}
{\footnotesize\ttfamily int rtems\+\_\+rfs\+\_\+link (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$}]{fs,  }\item[{const char $\ast$}]{name,  }\item[{int}]{length,  }\item[{\mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}}}]{parent,  }\item[{\mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}}}]{target,  }\item[{bool}]{link\+\_\+dir }\end{DoxyParamCaption})}

Create a link. Do not link directories unless renaming or you will create loops in the file system.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em fs} & is the file system. \\
\hline
\mbox{\texttt{ in}}  & {\em name} & is a pointer to the name of the link. \\
\hline
\mbox{\texttt{ in}}  & {\em length} & is the length of the name. \\
\hline
\mbox{\texttt{ in}}  & {\em parent} & is the inode number of the parent directory. \\
\hline
\mbox{\texttt{ in}}  & {\em target} & is the inode of the target. \\
\hline
\mbox{\texttt{ in}}  & {\em link\+\_\+dir} & If true directories can be linked. Useful when renaming.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & Successful operation. \\
\hline
{\em error\+\_\+code} & An error occurred. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{rtems-rfs-link_8h_ad174cb40689aacab6621b9df946bc3f3}\label{rtems-rfs-link_8h_ad174cb40689aacab6621b9df946bc3f3}} 
\index{rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}!rtems\_rfs\_symlink@{rtems\_rfs\_symlink}}
\index{rtems\_rfs\_symlink@{rtems\_rfs\_symlink}!rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}}
\subsubsection{\texorpdfstring{rtems\_rfs\_symlink()}{rtems\_rfs\_symlink()}}
{\footnotesize\ttfamily int rtems\+\_\+rfs\+\_\+symlink (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$}]{fs,  }\item[{const char $\ast$}]{name,  }\item[{int}]{length,  }\item[{const char $\ast$}]{link,  }\item[{int}]{link\+\_\+length,  }\item[{uid\+\_\+t}]{uid,  }\item[{gid\+\_\+t}]{gid,  }\item[{\mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}}}]{parent }\end{DoxyParamCaption})}

Symbolic link is an inode that has a path attached.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em fs} & is the file system data. \\
\hline
\mbox{\texttt{ in}}  & {\em name} & is a pointer to the name of the node. \\
\hline
\mbox{\texttt{ in}}  & {\em length} & is the length of the name of the node. \\
\hline
\mbox{\texttt{ in}}  & {\em link} & is a pointer to the link path attached to the symlink inode. \\
\hline
\mbox{\texttt{ in}}  & {\em link\+\_\+length} & is the length of the link path. \\
\hline
\mbox{\texttt{ in}}  & {\em parent} & is the parent inode number.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & Successful operation. \\
\hline
{\em error\+\_\+code} & An error occurred. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{rtems-rfs-link_8h_a41b4368e951ea5b33913fd5e1a7d2c80}\label{rtems-rfs-link_8h_a41b4368e951ea5b33913fd5e1a7d2c80}} 
\index{rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}!rtems\_rfs\_symlink\_read@{rtems\_rfs\_symlink\_read}}
\index{rtems\_rfs\_symlink\_read@{rtems\_rfs\_symlink\_read}!rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}}
\subsubsection{\texorpdfstring{rtems\_rfs\_symlink\_read()}{rtems\_rfs\_symlink\_read()}}
{\footnotesize\ttfamily int rtems\+\_\+rfs\+\_\+symlink\+\_\+read (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$}]{fs,  }\item[{\mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}}}]{link,  }\item[{char $\ast$}]{path,  }\item[{size\+\_\+t}]{size,  }\item[{size\+\_\+t $\ast$}]{length }\end{DoxyParamCaption})}

Read a symbolic link into the provided buffer returning the link of link name.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em fs} & is the file system data. \\
\hline
\mbox{\texttt{ in}}  & {\em link} & is the link inode number to read. \\
\hline
\mbox{\texttt{ in}}  & {\em path} & is a pointer to the buffer to write the link path into. \\
\hline
\mbox{\texttt{ in}}  & {\em size} & is the size of the buffer. \\
\hline
\mbox{\texttt{ out}}  & {\em length} & will contain the length of the link path.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & Successful operation. \\
\hline
{\em error\+\_\+code} & An error occurred. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{rtems-rfs-link_8h_a688547629f6f92228919b7938a1cbfb4}\label{rtems-rfs-link_8h_a688547629f6f92228919b7938a1cbfb4}} 
\index{rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}!rtems\_rfs\_unlink@{rtems\_rfs\_unlink}}
\index{rtems\_rfs\_unlink@{rtems\_rfs\_unlink}!rtems-\/rfs-\/link.h@{rtems-\/rfs-\/link.h}}
\subsubsection{\texorpdfstring{rtems\_rfs\_unlink()}{rtems\_rfs\_unlink()}}
{\footnotesize\ttfamily int rtems\+\_\+rfs\+\_\+unlink (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct__rtems__rfs__file__system}{rtems\+\_\+rfs\+\_\+file\+\_\+system}} $\ast$}]{fs,  }\item[{\mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}}}]{parent,  }\item[{\mbox{\hyperlink{rtems-rfs-inode_8h_ae658325c3ff9941f2e68315d20e3c723}{rtems\+\_\+rfs\+\_\+ino}}}]{target,  }\item[{uint32\+\_\+t}]{doff,  }\item[{\mbox{\hyperlink{rtems-rfs-link_8h_aa5069a5066794404a5afb31ac6067cd0}{rtems\+\_\+rfs\+\_\+unlink\+\_\+dir}}}]{dir\+\_\+mode }\end{DoxyParamCaption})}

Unlink the node from the parent directory. A directory offset for the target entry is required because links cause a number of inode numbers to appear in a single directory so scanning does not work.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em fs} & is the file system. \\
\hline
\mbox{\texttt{ in}}  & {\em parent} & is the inode number of the parent directory. \\
\hline
\mbox{\texttt{ in}}  & {\em target} & is the inode of the target. \\
\hline
\mbox{\texttt{ in}}  & {\em doff} & is the parent directory entry offset for the target entry. \\
\hline
\mbox{\texttt{ in}}  & {\em dir\+\_\+mode} & is the directory unlink mode.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & Successful operation. \\
\hline
{\em error\+\_\+code} & An error occurred. \\
\hline
\end{DoxyRetVals}
