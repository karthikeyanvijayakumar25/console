\hypertarget{group__RTEMSBSPsPowerPCMPC55XX}{}\section{N\+XP M\+P\+C55\+XX and M\+P\+C56\+XX}
\label{group__RTEMSBSPsPowerPCMPC55XX}\index{NXP MPC55XX and MPC56XX@{NXP MPC55XX and MPC56XX}}


N\+XP M\+P\+C55\+XX and M\+P\+C56\+XX Board Support Package.  


\subsection*{Modules}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{group__mpc55xx__config}{Configuration files}}
\item 
\mbox{\hyperlink{group__mpc55xx__dspi}{Deserial Serial Peripheral Interface (\+D\+S\+P\+I)}}
\end{DoxyCompactItemize}
\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \mbox{\hyperlink{mpc55xxevb_2clock_2clock-config_8c}{clock-\/config.\+c}}
\begin{DoxyCompactList}\small\item\em Clock driver configuration. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{bsps_2powerpc_2mpc55xxevb_2include_2bsp_2irq_8h}{irq.\+h}}
\begin{DoxyCompactList}\small\item\em I\+RQ. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{mpc55xx-config_8h}{mpc55xx-\/config.\+h}}
\begin{DoxyCompactList}\small\item\em Low-\/level configuration. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{smsc9218i_8h}{smsc9218i.\+h}}
\begin{DoxyCompactList}\small\item\em S\+M\+SC -\/ L\+A\+N9218i. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{bsps_2powerpc_2mpc55xxevb_2include_2bsp_8h}{bsp.\+h}}
\begin{DoxyCompactList}\small\item\em Global B\+SP definitions. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{edma_8h}{edma.\+h}}
\begin{DoxyCompactList}\small\item\em Enhanced Direct Memory Access (e\+D\+MA). \end{DoxyCompactList}\item 
file \mbox{\hyperlink{emios_8h}{emios.\+h}}
\begin{DoxyCompactList}\small\item\em Enhanced Modular Input Output Subsystem (e\+M\+I\+OS). \end{DoxyCompactList}\item 
file \mbox{\hyperlink{mpc55xx_8h}{mpc55xx.\+h}}
\begin{DoxyCompactList}\small\item\em Documentation for this file. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{reg-defs_8h}{reg-\/defs.\+h}}
\begin{DoxyCompactList}\small\item\em Register definitions. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{regs-edma_8h}{regs-\/edma.\+h}}
\item 
file \mbox{\hyperlink{regs-mmu_8h}{regs-\/mmu.\+h}}
\item 
file \mbox{\hyperlink{powerpc_2mpc55xxevb_2include_2mpc55xx_2regs_8h}{regs.\+h}}
\begin{DoxyCompactList}\small\item\em Register definitions for the M\+P\+C55xx and M\+P\+C56xx microcontroller family. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{siu_8h}{siu.\+h}}
\begin{DoxyCompactList}\small\item\em System Integration Unit Access (S\+IU). \end{DoxyCompactList}\item 
file \mbox{\hyperlink{bsps_2powerpc_2mpc55xxevb_2include_2mpc55xx_2watchdog_8h}{watchdog.\+h}}
\begin{DoxyCompactList}\small\item\em Header file for the watchdog timer. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{smsc9218i_8c}{smsc9218i.\+c}}
\begin{DoxyCompactList}\small\item\em S\+M\+SC -\/ L\+A\+N9218i. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{powerpc_2mpc55xxevb_2start_2bspgetworkarea_8c}{bspgetworkarea.\+c}}
\item 
file \mbox{\hyperlink{powerpc_2mpc55xxevb_2start_2bspreset_8c}{bspreset.\+c}}
\begin{DoxyCompactList}\small\item\em B\+SP reset. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{powerpc_2mpc55xxevb_2start_2bspstart_8c}{bspstart.\+c}}
\begin{DoxyCompactList}\small\item\em B\+SP startup code. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{edma_8c}{edma.\+c}}
\begin{DoxyCompactList}\small\item\em Enhanced Direct Memory Access (e\+D\+MA). \end{DoxyCompactList}\item 
file \mbox{\hyperlink{emios_8c}{emios.\+c}}
\begin{DoxyCompactList}\small\item\em Enhanced Modular Input Output Subsystem (e\+M\+I\+OS). \end{DoxyCompactList}\item 
file \mbox{\hyperlink{flash__support_8c}{flash\+\_\+support.\+c}}
\begin{DoxyCompactList}\small\item\em M\+P\+C55\+XX flash memory support. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{get-system-clock_8c}{get-\/system-\/clock.\+c}}
\begin{DoxyCompactList}\small\item\em System clock calculation. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{idle-thread_8c}{idle-\/thread.\+c}}
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{group__RTEMSBSPsARMLPC176X_ga301be7085b80c41a9c5887247003c662}{bsp\+\_\+idle\+\_\+thread()}} implementation. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{bsps_2powerpc_2mpc55xxevb_2start_2irq_8c}{irq.\+c}}
\begin{DoxyCompactList}\small\item\em Source file for M\+P\+C55\+XX interrupt support. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{sd-card-init_8c}{sd-\/card-\/init.\+c}}
\begin{DoxyCompactList}\small\item\em SD Card initialization code. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{siu_8c}{siu.\+c}}
\begin{DoxyCompactList}\small\item\em System Integration Unit Access (S\+IU). \end{DoxyCompactList}\item 
file \mbox{\hyperlink{start-clock_8c}{start-\/clock.\+c}}
\begin{DoxyCompactList}\small\item\em Clock and F\+M\+P\+LL initialization code. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{start-config-clock_8c}{start-\/config-\/clock.\+c}}
\begin{DoxyCompactList}\small\item\em Clock and F\+M\+P\+LL configuration. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{start-config-ebi-cs-cal_8c}{start-\/config-\/ebi-\/cs-\/cal.\+c}}
\begin{DoxyCompactList}\small\item\em E\+BI calibration chip-\/select configuration. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{start-config-ebi-cs_8c}{start-\/config-\/ebi-\/cs.\+c}}
\begin{DoxyCompactList}\small\item\em E\+BI chip-\/select configuration. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{start-config-ebi_8c}{start-\/config-\/ebi.\+c}}
\begin{DoxyCompactList}\small\item\em E\+BI configuration. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{start-config-mmu-early_8c}{start-\/config-\/mmu-\/early.\+c}}
\begin{DoxyCompactList}\small\item\em M\+MU early configuration. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{start-config-mmu_8c}{start-\/config-\/mmu.\+c}}
\begin{DoxyCompactList}\small\item\em M\+MU configuration. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{start-config-siu-pcr_8c}{start-\/config-\/siu-\/pcr.\+c}}
\begin{DoxyCompactList}\small\item\em S\+IU P\+CR configuration. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{start-early_8c}{start-\/early.\+c}}
\begin{DoxyCompactList}\small\item\em Early initialization code. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{start-prologue_8c}{start-\/prologue.\+c}}
\begin{DoxyCompactList}\small\item\em Start prologue. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{start-watchdog_8c}{start-\/watchdog.\+c}}
\begin{DoxyCompactList}\small\item\em Watchdog initialization code. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_ga5d7d631d3a14b7554160f14eb42f351b}\label{group__RTEMSBSPsPowerPCMPC55XX_ga5d7d631d3a14b7554160f14eb42f351b}} 
\#define {\bfseries B\+S\+P\+\_\+\+F\+E\+A\+T\+U\+R\+E\+\_\+\+I\+R\+Q\+\_\+\+E\+X\+T\+E\+N\+S\+I\+ON}
\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_ga51d0f3a059b2d9a6aa154a085ffb26f7}\label{group__RTEMSBSPsPowerPCMPC55XX_ga51d0f3a059b2d9a6aa154a085ffb26f7}} 
\#define {\bfseries M\+P\+C55\+X\+X\+\_\+\+P\+E\+R\+I\+P\+H\+E\+R\+A\+L\+\_\+\+C\+L\+O\+CK}~(M\+P\+C55\+X\+X\+\_\+\+S\+Y\+S\+T\+E\+M\+\_\+\+C\+L\+O\+CK / M\+P\+C55\+X\+X\+\_\+\+S\+Y\+S\+T\+E\+M\+\_\+\+C\+L\+O\+C\+K\+\_\+\+D\+I\+V\+I\+D\+ER)
\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_ga5b3b7a8f2f89a6110c93e0229f67c104}\label{group__RTEMSBSPsPowerPCMPC55XX_ga5b3b7a8f2f89a6110c93e0229f67c104}} 
\#define \mbox{\hyperlink{group__RTEMSBSPsPowerPCMPC55XX_ga5b3b7a8f2f89a6110c93e0229f67c104}{B\+S\+P\+\_\+\+Convert\+\_\+decrementer}}(\+\_\+value)~(((unsigned long long) (\+\_\+value)) / ((unsigned long long)\mbox{\hyperlink{group__RTEMSBSPsPowerPCGen83XX_gabfae404b02d5b3193b9420930d97d84a}{bsp\+\_\+clicks\+\_\+per\+\_\+usec}}))
\begin{DoxyCompactList}\small\item\em Convert Decrementer ticks to microseconds. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_gadde0d66aef9442971dde465292ac14e6}\label{group__RTEMSBSPsPowerPCMPC55XX_gadde0d66aef9442971dde465292ac14e6}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+S\+P\+\_\+\+N\+E\+T\+W\+O\+R\+K\+\_\+\+D\+R\+I\+V\+E\+R\+\_\+\+A\+T\+T\+A\+CH}~smsc9218i\+\_\+attach\+\_\+detach
\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_ga86d4f9aa98431100692e31068070a8df}\label{group__RTEMSBSPsPowerPCMPC55XX_ga86d4f9aa98431100692e31068070a8df}} 
\#define {\bfseries R\+T\+E\+M\+S\+\_\+\+B\+S\+P\+\_\+\+N\+E\+T\+W\+O\+R\+K\+\_\+\+D\+R\+I\+V\+E\+R\+\_\+\+N\+A\+ME}~\char`\"{}eth0\char`\"{}
\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_ga4aa606d0badadcc28e8054cb60f13b56}\label{group__RTEMSBSPsPowerPCMPC55XX_ga4aa606d0badadcc28e8054cb60f13b56}} 
\#define {\bfseries B\+S\+P\+\_\+\+I\+D\+L\+E\+\_\+\+T\+A\+S\+K\+\_\+\+B\+O\+DY}~\mbox{\hyperlink{group__RTEMSBSPsSPARCLEON3_ga301be7085b80c41a9c5887247003c662}{bsp\+\_\+idle\+\_\+thread}}
\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_ga434fb278cd269832ef8797a809f17d46}\label{group__RTEMSBSPsPowerPCMPC55XX_ga434fb278cd269832ef8797a809f17d46}} 
\#define {\bfseries B\+S\+P\+\_\+\+D\+S\+R\+A\+M\+\_\+\+S\+E\+C\+T\+I\+ON}~\mbox{\hyperlink{struct____attribute____}{\+\_\+\+\_\+attribute\+\_\+\+\_\+}}((section(\char`\"{}.bsp\+\_\+dsram\char`\"{})))
\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_gaf2ed4519175143d048269d689b466626}\label{group__RTEMSBSPsPowerPCMPC55XX_gaf2ed4519175143d048269d689b466626}} 
\#define {\bfseries B\+S\+P\+\_\+\+S\+Y\+S\+R\+A\+M\+\_\+\+S\+E\+C\+T\+I\+ON}~\mbox{\hyperlink{struct____attribute____}{\+\_\+\+\_\+attribute\+\_\+\+\_\+}}((section(\char`\"{}.bsp\+\_\+sysram\char`\"{})))
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_ga199ddeab1255d89ddf244ce534ad1d8c}\label{group__RTEMSBSPsPowerPCMPC55XX_ga199ddeab1255d89ddf244ce534ad1d8c}} 
\mbox{\hyperlink{group__ClassicStatus_ga545d41846817eaba6143d52ee4d9e9fe}{rtems\+\_\+status\+\_\+code}} {\bfseries mpc55xx\+\_\+sd\+\_\+card\+\_\+init} (bool \mbox{\hyperlink{group__FileSystemTypesAndMount_gaf3c1bed49bb0f3dec88d330b4f88d48b}{mount}})
\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_gaf4ff44e324dae103a062c5882434d09c}\label{group__RTEMSBSPsPowerPCMPC55XX_gaf4ff44e324dae103a062c5882434d09c}} 
int {\bfseries smsc9218i\+\_\+attach\+\_\+detach} (struct rtems\+\_\+bsdnet\+\_\+ifconfig $\ast$\mbox{\hyperlink{structconfig__s}{config}}, int attaching)
\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_ga58027abea7da23dc91a07af3260fa365}\label{group__RTEMSBSPsPowerPCMPC55XX_ga58027abea7da23dc91a07af3260fa365}} 
\mbox{\hyperlink{group__ClassicStatus_ga545d41846817eaba6143d52ee4d9e9fe}{rtems\+\_\+status\+\_\+code}} {\bfseries bsp\+\_\+register\+\_\+i2c} (void)
\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_ga22e8ff0c484a388835087ab82844fa5b}\label{group__RTEMSBSPsPowerPCMPC55XX_ga22e8ff0c484a388835087ab82844fa5b}} 
void {\bfseries bsp\+\_\+restart} (void $\ast$addr)
\item 
void $\ast$ \mbox{\hyperlink{group__RTEMSBSPsPowerPCMPC55XX_ga4617d29eb64a6f41a54d9f997b97d758}{bsp\+\_\+idle\+\_\+thread}} (uintptr\+\_\+t arg)
\begin{DoxyCompactList}\small\item\em Optimized idle task. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_gaba9da0e1051e94af45015aa2b1c30cfb}\label{group__RTEMSBSPsPowerPCMPC55XX_gaba9da0e1051e94af45015aa2b1c30cfb}} 
unsigned int \mbox{\hyperlink{group__RTEMSBSPsPowerPCMPC55XX_gaba9da0e1051e94af45015aa2b1c30cfb}{bsp\+\_\+clock\+\_\+speed}}
\begin{DoxyCompactList}\small\item\em System clock frequency. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_gabfae404b02d5b3193b9420930d97d84a}\label{group__RTEMSBSPsPowerPCMPC55XX_gabfae404b02d5b3193b9420930d97d84a}} 
uint32\+\_\+t \mbox{\hyperlink{group__RTEMSBSPsPowerPCMPC55XX_gabfae404b02d5b3193b9420930d97d84a}{bsp\+\_\+clicks\+\_\+per\+\_\+usec}}
\begin{DoxyCompactList}\small\item\em Time base clicks per micro second. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
N\+XP M\+P\+C55\+XX and M\+P\+C56\+XX Board Support Package. 



\subsection{Function Documentation}
\mbox{\Hypertarget{group__RTEMSBSPsPowerPCMPC55XX_ga4617d29eb64a6f41a54d9f997b97d758}\label{group__RTEMSBSPsPowerPCMPC55XX_ga4617d29eb64a6f41a54d9f997b97d758}} 
\index{NXP MPC55XX and MPC56XX@{NXP MPC55XX and MPC56XX}!bsp\_idle\_thread@{bsp\_idle\_thread}}
\index{bsp\_idle\_thread@{bsp\_idle\_thread}!NXP MPC55XX and MPC56XX@{NXP MPC55XX and MPC56XX}}
\subsubsection{\texorpdfstring{bsp\_idle\_thread()}{bsp\_idle\_thread()}}
{\footnotesize\ttfamily void$\ast$ bsp\+\_\+idle\+\_\+thread (\begin{DoxyParamCaption}\item[{uintptr\+\_\+t}]{ignored }\end{DoxyParamCaption})}



Optimized idle task. 

This B\+SP provides its own I\+D\+LE thread to override the R\+T\+E\+MS one.

This idle task sets the power mode to idle. This causes the processor clock to be stopped, while on-\/chip peripherals remain active. Any enabled interrupt from a peripheral or an external interrupt source will cause the processor to resume execution.

To enable the idle task use the following in the system configuration\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <bsp.h>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#define CONFIGURE\_INIT}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#define CONFIGURE\_IDLE\_TASK\_BODY bsp\_idle\_thread}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <\mbox{\hyperlink{confdefs_8h}{confdefs.h}}>}}
\end{DoxyCode}


This B\+SP provides its own I\+D\+LE thread to override the R\+T\+E\+MS one.

Optimized idle task.

The M\+SR\mbox{[}P\+OW\mbox{]} bit is set to put the C\+PU into the low power mode defined in H\+I\+D0. H\+I\+D0 is set during starup in start.\+S.

This B\+SP provides its own I\+D\+LE thread to override the R\+T\+E\+MS one.

This idle task sets the power mode to idle. This causes the processor clock to be stopped, while on-\/chip peripherals remain active. Any enabled interrupt from a peripheral or an external interrupt source will cause the processor to resume execution.

To enable the idle task use the following in the system configuration\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <bsp.h>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#define CONFIGURE\_INIT}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#define CONFIGURE\_IDLE\_TASK\_BODY bsp\_idle\_thread}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <\mbox{\hyperlink{confdefs_8h}{confdefs.h}}>}}
\end{DoxyCode}


Optimized idle task.

The M\+SR\mbox{[}P\+OW\mbox{]} bit is set to put the C\+PU into the low power mode defined in H\+I\+D0. H\+I\+D0 is set during starup in start.\+S. 