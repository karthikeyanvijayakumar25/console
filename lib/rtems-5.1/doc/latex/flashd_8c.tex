\hypertarget{flashd_8c}{}\section{bsps/arm/atsam/contrib/libraries/libchip/source/flashd.c File Reference}
\label{flashd_8c}\index{bsps/arm/atsam/contrib/libraries/libchip/source/flashd.c@{bsps/arm/atsam/contrib/libraries/libchip/source/flashd.c}}
{\ttfamily \#include \char`\"{}chip.\+h\char`\"{}}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$assert.\+h$>$}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{flashd_8c_a4dc700a9281a7ce30340a2276a9f44b3}\label{flashd_8c_a4dc700a9281a7ce30340a2276a9f44b3}} 
\#define {\bfseries G\+P\+N\+V\+M\+\_\+\+N\+U\+M\+\_\+\+M\+AX}~9
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{flashd_8c_abcd1cf006641b2c0ffe0ef95615f6b32}{F\+L\+A\+S\+H\+D\+\_\+\+Initialize}} (uint32\+\_\+t dw\+M\+Ck, uint32\+\_\+t dw\+Use\+I\+AP)
\begin{DoxyCompactList}\small\item\em Initializes the flash driver. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{flashd_8c_a009778fe212a220f68e923e18ef14103}{F\+L\+A\+S\+H\+D\+\_\+\+Erase}} (uint32\+\_\+t dw\+Address)
\begin{DoxyCompactList}\small\item\em Erases the entire flash. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{flashd_8c_a7263e451f8b2b08eacdf89e46192c96b}{F\+L\+A\+S\+H\+D\+\_\+\+Erase\+Sector}} (uint32\+\_\+t dw\+Address)
\begin{DoxyCompactList}\small\item\em Erases flash by sector. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{flashd_8c_a454beb98ffe72e55aa69670313c4fd6c}{F\+L\+A\+S\+H\+D\+\_\+\+Erase\+Pages}} (uint32\+\_\+t dw\+Address, uint32\+\_\+t dw\+Page\+Num)
\begin{DoxyCompactList}\small\item\em Erases flash by pages. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{flashd_8c_a2bfa853dcc6963b6c053ab4e9417a12c}{F\+L\+A\+S\+H\+D\+\_\+\+Write}} (uint32\+\_\+t dw\+Address, const void $\ast$pv\+Buffer, uint32\+\_\+t dw\+Size)
\begin{DoxyCompactList}\small\item\em Writes a data buffer in the internal flash. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{flashd_8c_a29e89431146b26ca80a4926ad20e4b0a}{F\+L\+A\+S\+H\+D\+\_\+\+Lock}} (uint32\+\_\+t start, uint32\+\_\+t end, uint32\+\_\+t $\ast$p\+Actual\+Start, uint32\+\_\+t $\ast$p\+Actual\+End)
\begin{DoxyCompactList}\small\item\em Locks all the regions in the given address range. The actual lock range is reported through two output parameters. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{flashd_8c_a964a05cff2bc8f9d6477f4cf70f253d9}{F\+L\+A\+S\+H\+D\+\_\+\+Unlock}} (uint32\+\_\+t start, uint32\+\_\+t end, uint32\+\_\+t $\ast$p\+Actual\+Start, uint32\+\_\+t $\ast$p\+Actual\+End)
\begin{DoxyCompactList}\small\item\em Unlocks all the regions in the given address range. The actual unlock range is reported through two output parameters. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{flashd_8c_a0e4b85a84bb516ced1e39bd110ebce7d}{F\+L\+A\+S\+H\+D\+\_\+\+Is\+Locked}} (uint32\+\_\+t start, uint32\+\_\+t end)
\begin{DoxyCompactList}\small\item\em Returns the number of locked regions inside the given address range. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{flashd_8c_a1ff2939b103369d0a692d2e30b526e0c}{F\+L\+A\+S\+H\+D\+\_\+\+Is\+G\+P\+N\+V\+M\+Set}} (uint8\+\_\+t uc\+G\+P\+N\+VM)
\begin{DoxyCompactList}\small\item\em Check if the given G\+P\+N\+VM bit is set or not. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{flashd_8c_aeec5f51a495cb3a4b2199e1fae1dadd0}{F\+L\+A\+S\+H\+D\+\_\+\+Set\+G\+P\+N\+VM}} (uint8\+\_\+t uc\+G\+P\+N\+VM)
\begin{DoxyCompactList}\small\item\em Sets the selected G\+P\+N\+VM bit. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{flashd_8c_ae7a300e050a12cb95924da15da085fdf}{F\+L\+A\+S\+H\+D\+\_\+\+Clear\+G\+P\+N\+VM}} (uint8\+\_\+t uc\+G\+P\+N\+VM)
\begin{DoxyCompactList}\small\item\em Clears the selected G\+P\+N\+VM bit. \end{DoxyCompactList}\item 
\mbox{\hyperlink{flashd_8c_abe19dd57d8f5134d05760d0adef58c7f}{\+\_\+\+\_\+attribute\+\_\+\+\_\+}} ((section(\char`\"{}.ramfunc\char`\"{})))
\begin{DoxyCompactList}\small\item\em Read the unique ID. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
The flash driver provides the unified interface for flash program operations. 

\subsection{Function Documentation}
\mbox{\Hypertarget{flashd_8c_abe19dd57d8f5134d05760d0adef58c7f}\label{flashd_8c_abe19dd57d8f5134d05760d0adef58c7f}} 
\index{flashd.c@{flashd.c}!\_\_attribute\_\_@{\_\_attribute\_\_}}
\index{\_\_attribute\_\_@{\_\_attribute\_\_}!flashd.c@{flashd.c}}
\subsubsection{\texorpdfstring{\_\_attribute\_\_()}{\_\_attribute\_\_()}}
{\footnotesize\ttfamily \mbox{\hyperlink{struct____attribute____}{\+\_\+\+\_\+attribute\+\_\+\+\_\+}} (\begin{DoxyParamCaption}\item[{(section(\char`\"{}.ramfunc\char`\"{}))}]{ }\end{DoxyParamCaption})}



Read the unique ID. 


\begin{DoxyParams}{Parameters}
{\em pdw\+Unique\+ID} & pointer on a 4bytes char containing the unique ID value. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful; otherwise returns an error code. 
\end{DoxyReturn}
\mbox{\Hypertarget{flashd_8c_ae7a300e050a12cb95924da15da085fdf}\label{flashd_8c_ae7a300e050a12cb95924da15da085fdf}} 
\index{flashd.c@{flashd.c}!FLASHD\_ClearGPNVM@{FLASHD\_ClearGPNVM}}
\index{FLASHD\_ClearGPNVM@{FLASHD\_ClearGPNVM}!flashd.c@{flashd.c}}
\subsubsection{\texorpdfstring{FLASHD\_ClearGPNVM()}{FLASHD\_ClearGPNVM()}}
{\footnotesize\ttfamily uint32\+\_\+t F\+L\+A\+S\+H\+D\+\_\+\+Clear\+G\+P\+N\+VM (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{uc\+G\+P\+N\+VM }\end{DoxyParamCaption})}



Clears the selected G\+P\+N\+VM bit. 


\begin{DoxyParams}{Parameters}
{\em gpnvm} & G\+P\+N\+VM bit index. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful; otherwise returns an error code. 
\end{DoxyReturn}
\mbox{\Hypertarget{flashd_8c_a009778fe212a220f68e923e18ef14103}\label{flashd_8c_a009778fe212a220f68e923e18ef14103}} 
\index{flashd.c@{flashd.c}!FLASHD\_Erase@{FLASHD\_Erase}}
\index{FLASHD\_Erase@{FLASHD\_Erase}!flashd.c@{flashd.c}}
\subsubsection{\texorpdfstring{FLASHD\_Erase()}{FLASHD\_Erase()}}
{\footnotesize\ttfamily uint32\+\_\+t F\+L\+A\+S\+H\+D\+\_\+\+Erase (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{dw\+Address }\end{DoxyParamCaption})}



Erases the entire flash. 


\begin{DoxyParams}{Parameters}
{\em dw\+Address} & Flash start address. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful; otherwise returns an error code. 
\end{DoxyReturn}
\mbox{\Hypertarget{flashd_8c_a454beb98ffe72e55aa69670313c4fd6c}\label{flashd_8c_a454beb98ffe72e55aa69670313c4fd6c}} 
\index{flashd.c@{flashd.c}!FLASHD\_ErasePages@{FLASHD\_ErasePages}}
\index{FLASHD\_ErasePages@{FLASHD\_ErasePages}!flashd.c@{flashd.c}}
\subsubsection{\texorpdfstring{FLASHD\_ErasePages()}{FLASHD\_ErasePages()}}
{\footnotesize\ttfamily uint32\+\_\+t F\+L\+A\+S\+H\+D\+\_\+\+Erase\+Pages (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{dw\+Address,  }\item[{uint32\+\_\+t}]{dw\+Page\+Num }\end{DoxyParamCaption})}



Erases flash by pages. 


\begin{DoxyParams}{Parameters}
{\em dw\+Address} & Start address of be erased pages. \\
\hline
{\em dw\+Page\+Num} & Number of pages to be erased with E\+PA command (4, 8, 16, 32)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful; otherwise returns an error code. 
\end{DoxyReturn}
\mbox{\Hypertarget{flashd_8c_a7263e451f8b2b08eacdf89e46192c96b}\label{flashd_8c_a7263e451f8b2b08eacdf89e46192c96b}} 
\index{flashd.c@{flashd.c}!FLASHD\_EraseSector@{FLASHD\_EraseSector}}
\index{FLASHD\_EraseSector@{FLASHD\_EraseSector}!flashd.c@{flashd.c}}
\subsubsection{\texorpdfstring{FLASHD\_EraseSector()}{FLASHD\_EraseSector()}}
{\footnotesize\ttfamily uint32\+\_\+t F\+L\+A\+S\+H\+D\+\_\+\+Erase\+Sector (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{dw\+Address }\end{DoxyParamCaption})}



Erases flash by sector. 


\begin{DoxyParams}{Parameters}
{\em dw\+Address} & Start address of be erased sector.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful; otherwise returns an error code. 
\end{DoxyReturn}
\mbox{\Hypertarget{flashd_8c_abcd1cf006641b2c0ffe0ef95615f6b32}\label{flashd_8c_abcd1cf006641b2c0ffe0ef95615f6b32}} 
\index{flashd.c@{flashd.c}!FLASHD\_Initialize@{FLASHD\_Initialize}}
\index{FLASHD\_Initialize@{FLASHD\_Initialize}!flashd.c@{flashd.c}}
\subsubsection{\texorpdfstring{FLASHD\_Initialize()}{FLASHD\_Initialize()}}
{\footnotesize\ttfamily void F\+L\+A\+S\+H\+D\+\_\+\+Initialize (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{dw\+M\+Ck,  }\item[{uint32\+\_\+t}]{dw\+Use\+I\+AP }\end{DoxyParamCaption})}



Initializes the flash driver. 


\begin{DoxyParams}{Parameters}
{\em dw\+M\+Ck} & Master clock frequency in Hz. \\
\hline
{\em dw\+Use\+I\+AP} & 0\+: use E\+E\+FC controller interface, 1\+: use I\+AP interface. dw\+Use\+I\+AP should be set to 1 when running out of flash. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{flashd_8c_a1ff2939b103369d0a692d2e30b526e0c}\label{flashd_8c_a1ff2939b103369d0a692d2e30b526e0c}} 
\index{flashd.c@{flashd.c}!FLASHD\_IsGPNVMSet@{FLASHD\_IsGPNVMSet}}
\index{FLASHD\_IsGPNVMSet@{FLASHD\_IsGPNVMSet}!flashd.c@{flashd.c}}
\subsubsection{\texorpdfstring{FLASHD\_IsGPNVMSet()}{FLASHD\_IsGPNVMSet()}}
{\footnotesize\ttfamily uint32\+\_\+t F\+L\+A\+S\+H\+D\+\_\+\+Is\+G\+P\+N\+V\+M\+Set (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{uc\+G\+P\+N\+VM }\end{DoxyParamCaption})}



Check if the given G\+P\+N\+VM bit is set or not. 


\begin{DoxyParams}{Parameters}
{\em gpnvm} & G\+P\+N\+VM bit index. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if the given G\+P\+N\+VM bit is currently set; otherwise returns 0. 
\end{DoxyReturn}
\mbox{\Hypertarget{flashd_8c_a0e4b85a84bb516ced1e39bd110ebce7d}\label{flashd_8c_a0e4b85a84bb516ced1e39bd110ebce7d}} 
\index{flashd.c@{flashd.c}!FLASHD\_IsLocked@{FLASHD\_IsLocked}}
\index{FLASHD\_IsLocked@{FLASHD\_IsLocked}!flashd.c@{flashd.c}}
\subsubsection{\texorpdfstring{FLASHD\_IsLocked()}{FLASHD\_IsLocked()}}
{\footnotesize\ttfamily uint32\+\_\+t F\+L\+A\+S\+H\+D\+\_\+\+Is\+Locked (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{start,  }\item[{uint32\+\_\+t}]{end }\end{DoxyParamCaption})}



Returns the number of locked regions inside the given address range. 


\begin{DoxyParams}{Parameters}
{\em start} & Start address of range \\
\hline
{\em end} & End address of range. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{flashd_8c_a29e89431146b26ca80a4926ad20e4b0a}\label{flashd_8c_a29e89431146b26ca80a4926ad20e4b0a}} 
\index{flashd.c@{flashd.c}!FLASHD\_Lock@{FLASHD\_Lock}}
\index{FLASHD\_Lock@{FLASHD\_Lock}!flashd.c@{flashd.c}}
\subsubsection{\texorpdfstring{FLASHD\_Lock()}{FLASHD\_Lock()}}
{\footnotesize\ttfamily uint32\+\_\+t F\+L\+A\+S\+H\+D\+\_\+\+Lock (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{start,  }\item[{uint32\+\_\+t}]{end,  }\item[{uint32\+\_\+t $\ast$}]{p\+Actual\+Start,  }\item[{uint32\+\_\+t $\ast$}]{p\+Actual\+End }\end{DoxyParamCaption})}



Locks all the regions in the given address range. The actual lock range is reported through two output parameters. 


\begin{DoxyParams}{Parameters}
{\em start} & Start address of lock range. \\
\hline
{\em end} & End address of lock range. \\
\hline
{\em p\+Actual\+Start} & Start address of the actual lock range (optional). \\
\hline
{\em p\+Actual\+End} & End address of the actual lock range (optional). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful, otherwise returns an error code. 
\end{DoxyReturn}
\mbox{\Hypertarget{flashd_8c_aeec5f51a495cb3a4b2199e1fae1dadd0}\label{flashd_8c_aeec5f51a495cb3a4b2199e1fae1dadd0}} 
\index{flashd.c@{flashd.c}!FLASHD\_SetGPNVM@{FLASHD\_SetGPNVM}}
\index{FLASHD\_SetGPNVM@{FLASHD\_SetGPNVM}!flashd.c@{flashd.c}}
\subsubsection{\texorpdfstring{FLASHD\_SetGPNVM()}{FLASHD\_SetGPNVM()}}
{\footnotesize\ttfamily uint32\+\_\+t F\+L\+A\+S\+H\+D\+\_\+\+Set\+G\+P\+N\+VM (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{uc\+G\+P\+N\+VM }\end{DoxyParamCaption})}



Sets the selected G\+P\+N\+VM bit. 


\begin{DoxyParams}{Parameters}
{\em gpnvm} & G\+P\+N\+VM bit index. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful; otherwise returns an error code. 
\end{DoxyReturn}
\mbox{\Hypertarget{flashd_8c_a964a05cff2bc8f9d6477f4cf70f253d9}\label{flashd_8c_a964a05cff2bc8f9d6477f4cf70f253d9}} 
\index{flashd.c@{flashd.c}!FLASHD\_Unlock@{FLASHD\_Unlock}}
\index{FLASHD\_Unlock@{FLASHD\_Unlock}!flashd.c@{flashd.c}}
\subsubsection{\texorpdfstring{FLASHD\_Unlock()}{FLASHD\_Unlock()}}
{\footnotesize\ttfamily uint32\+\_\+t F\+L\+A\+S\+H\+D\+\_\+\+Unlock (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{start,  }\item[{uint32\+\_\+t}]{end,  }\item[{uint32\+\_\+t $\ast$}]{p\+Actual\+Start,  }\item[{uint32\+\_\+t $\ast$}]{p\+Actual\+End }\end{DoxyParamCaption})}



Unlocks all the regions in the given address range. The actual unlock range is reported through two output parameters. 


\begin{DoxyParams}{Parameters}
{\em start} & Start address of unlock range. \\
\hline
{\em end} & End address of unlock range. \\
\hline
{\em p\+Actual\+Start} & Start address of the actual unlock range (optional). \\
\hline
{\em p\+Actual\+End} & End address of the actual unlock range (optional). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful, otherwise returns an error code. 
\end{DoxyReturn}
\mbox{\Hypertarget{flashd_8c_a2bfa853dcc6963b6c053ab4e9417a12c}\label{flashd_8c_a2bfa853dcc6963b6c053ab4e9417a12c}} 
\index{flashd.c@{flashd.c}!FLASHD\_Write@{FLASHD\_Write}}
\index{FLASHD\_Write@{FLASHD\_Write}!flashd.c@{flashd.c}}
\subsubsection{\texorpdfstring{FLASHD\_Write()}{FLASHD\_Write()}}
{\footnotesize\ttfamily uint32\+\_\+t F\+L\+A\+S\+H\+D\+\_\+\+Write (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{dw\+Address,  }\item[{const void $\ast$}]{pv\+Buffer,  }\item[{uint32\+\_\+t}]{dw\+Size }\end{DoxyParamCaption})}



Writes a data buffer in the internal flash. 

\begin{DoxyNote}{Note}
This function works in polling mode, and thus only returns when the data has been effectively written. 
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em address} & Write address. \\
\hline
{\em p\+Buffer} & Data buffer. \\
\hline
{\em size} & Size of data buffer in bytes. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful, otherwise returns an error code. 
\end{DoxyReturn}
