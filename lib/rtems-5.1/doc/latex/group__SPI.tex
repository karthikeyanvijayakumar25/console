\hypertarget{group__SPI}{}\section{Serial Peripheral Interface (S\+PI) Driver}
\label{group__SPI}\index{Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}}


Serial Peripheral Interface (S\+PI) bus driver support.  


\subsection*{Modules}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{group__SPILinux}{Linux S\+P\+I User-\/\+Space A\+PI}}
\begin{DoxyCompactList}\small\item\em R\+T\+E\+MS port of Linux S\+PI user-\/space A\+PI. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \mbox{\hyperlink{cpukit_2include_2dev_2spi_2spi_8h}{spi.\+h}}
\begin{DoxyCompactList}\small\item\em Serial Peripheral Interface (S\+PI) Driver A\+PI. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structspi__bus}{spi\+\_\+bus}}
\begin{DoxyCompactList}\small\item\em S\+PI bus control. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{group__SPI_gacb010bcbdaab298a6893c06fbaff590c}{S\+P\+I\+\_\+\+B\+U\+S\+\_\+\+O\+B\+T\+A\+IN}}~\+\_\+\+IO(S\+P\+I\+\_\+\+I\+O\+C\+\_\+\+M\+A\+G\+IC, 13)
\begin{DoxyCompactList}\small\item\em Obtains the bus. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{group__SPI_ga7feb36e9867e404a0af9a15e68fef122}{S\+P\+I\+\_\+\+B\+U\+S\+\_\+\+R\+E\+L\+E\+A\+SE}}~\+\_\+\+IO(S\+P\+I\+\_\+\+I\+O\+C\+\_\+\+M\+A\+G\+IC, 23)
\begin{DoxyCompactList}\small\item\em Releases the bus. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{group__SPI_ga262496c8e444706de1774f57e65fb783}{spi\+\_\+bus\+\_\+init}} (\mbox{\hyperlink{structspi__bus}{spi\+\_\+bus}} $\ast$bus)
\begin{DoxyCompactList}\small\item\em Initializes a bus control. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structspi__bus}{spi\+\_\+bus}} $\ast$ \mbox{\hyperlink{group__SPI_ga009e374a9df42c65a879677a4434ed49}{spi\+\_\+bus\+\_\+alloc\+\_\+and\+\_\+init}} (size\+\_\+t \mbox{\hyperlink{sun4u_2tte_8h_a245260f6f74972558f61b85227df5aae}{size}})
\begin{DoxyCompactList}\small\item\em Allocates a bus control from the heap and initializes it. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group__SPI_ga6d316300e2bb231728d32b5dda355dcd}{spi\+\_\+bus\+\_\+destroy}} (\mbox{\hyperlink{structspi__bus}{spi\+\_\+bus}} $\ast$bus)
\begin{DoxyCompactList}\small\item\em Destroys a bus control. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group__SPI_ga6c6868bad5d8e9ea136b23947dd9a7a6}{spi\+\_\+bus\+\_\+destroy\+\_\+and\+\_\+free}} (\mbox{\hyperlink{structspi__bus}{spi\+\_\+bus}} $\ast$bus)
\begin{DoxyCompactList}\small\item\em Destroys a bus control and frees its memory. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__SPI_ga4e6ca0b1d473a6be4fbbefa2ed1a55f2}{spi\+\_\+bus\+\_\+register}} (\mbox{\hyperlink{structspi__bus}{spi\+\_\+bus}} $\ast$bus, const char $\ast$bus\+\_\+path)
\begin{DoxyCompactList}\small\item\em Registers a bus control. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Serial Peripheral Interface (S\+PI) bus driver support. 



\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{group__SPI_gacb010bcbdaab298a6893c06fbaff590c}\label{group__SPI_gacb010bcbdaab298a6893c06fbaff590c}} 
\index{Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}!SPI\_BUS\_OBTAIN@{SPI\_BUS\_OBTAIN}}
\index{SPI\_BUS\_OBTAIN@{SPI\_BUS\_OBTAIN}!Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}}
\subsubsection{\texorpdfstring{SPI\_BUS\_OBTAIN}{SPI\_BUS\_OBTAIN}}
{\footnotesize\ttfamily \#define S\+P\+I\+\_\+\+B\+U\+S\+\_\+\+O\+B\+T\+A\+IN~\+\_\+\+IO(S\+P\+I\+\_\+\+I\+O\+C\+\_\+\+M\+A\+G\+IC, 13)}



Obtains the bus. 

This command has no argument. \mbox{\Hypertarget{group__SPI_ga7feb36e9867e404a0af9a15e68fef122}\label{group__SPI_ga7feb36e9867e404a0af9a15e68fef122}} 
\index{Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}!SPI\_BUS\_RELEASE@{SPI\_BUS\_RELEASE}}
\index{SPI\_BUS\_RELEASE@{SPI\_BUS\_RELEASE}!Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}}
\subsubsection{\texorpdfstring{SPI\_BUS\_RELEASE}{SPI\_BUS\_RELEASE}}
{\footnotesize\ttfamily \#define S\+P\+I\+\_\+\+B\+U\+S\+\_\+\+R\+E\+L\+E\+A\+SE~\+\_\+\+IO(S\+P\+I\+\_\+\+I\+O\+C\+\_\+\+M\+A\+G\+IC, 23)}



Releases the bus. 

This command has no argument. 

\subsection{Function Documentation}
\mbox{\Hypertarget{group__SPI_ga009e374a9df42c65a879677a4434ed49}\label{group__SPI_ga009e374a9df42c65a879677a4434ed49}} 
\index{Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}!spi\_bus\_alloc\_and\_init@{spi\_bus\_alloc\_and\_init}}
\index{spi\_bus\_alloc\_and\_init@{spi\_bus\_alloc\_and\_init}!Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}}
\subsubsection{\texorpdfstring{spi\_bus\_alloc\_and\_init()}{spi\_bus\_alloc\_and\_init()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structspi__bus}{spi\+\_\+bus}}$\ast$ spi\+\_\+bus\+\_\+alloc\+\_\+and\+\_\+init (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})}



Allocates a bus control from the heap and initializes it. 

After a sucessful allocation and initialization the bus control must be destroyed via \mbox{\hyperlink{group__SPI_ga6c6868bad5d8e9ea136b23947dd9a7a6}{spi\+\_\+bus\+\_\+destroy\+\_\+and\+\_\+free()}}. A registered bus control will be automatically destroyed in case the device file is unlinked. Make sure to call \mbox{\hyperlink{group__SPI_ga6c6868bad5d8e9ea136b23947dd9a7a6}{spi\+\_\+bus\+\_\+destroy\+\_\+and\+\_\+free()}} in a custom destruction handler.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em size} & The size of the bus control. This enables the addition of bus controller specific data to the base bus control. The bus control is zero initialized.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em non-\/\+N\+U\+LL} & The new bus control. \\
\hline
{\em N\+U\+LL} & An error occurred. The errno is set to indicate the error.\\
\hline
\end{DoxyRetVals}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{group__SPI_ga4e6ca0b1d473a6be4fbbefa2ed1a55f2}{spi\+\_\+bus\+\_\+register()}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{group__SPI_ga6d316300e2bb231728d32b5dda355dcd}\label{group__SPI_ga6d316300e2bb231728d32b5dda355dcd}} 
\index{Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}!spi\_bus\_destroy@{spi\_bus\_destroy}}
\index{spi\_bus\_destroy@{spi\_bus\_destroy}!Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}}
\subsubsection{\texorpdfstring{spi\_bus\_destroy()}{spi\_bus\_destroy()}}
{\footnotesize\ttfamily void spi\+\_\+bus\+\_\+destroy (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structspi__bus}{spi\+\_\+bus}} $\ast$}]{bus }\end{DoxyParamCaption})}



Destroys a bus control. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em bus} & The bus control. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{group__SPI_ga6c6868bad5d8e9ea136b23947dd9a7a6}\label{group__SPI_ga6c6868bad5d8e9ea136b23947dd9a7a6}} 
\index{Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}!spi\_bus\_destroy\_and\_free@{spi\_bus\_destroy\_and\_free}}
\index{spi\_bus\_destroy\_and\_free@{spi\_bus\_destroy\_and\_free}!Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}}
\subsubsection{\texorpdfstring{spi\_bus\_destroy\_and\_free()}{spi\_bus\_destroy\_and\_free()}}
{\footnotesize\ttfamily void spi\+\_\+bus\+\_\+destroy\+\_\+and\+\_\+free (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structspi__bus}{spi\+\_\+bus}} $\ast$}]{bus }\end{DoxyParamCaption})}



Destroys a bus control and frees its memory. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em bus} & The bus control. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{group__SPI_ga262496c8e444706de1774f57e65fb783}\label{group__SPI_ga262496c8e444706de1774f57e65fb783}} 
\index{Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}!spi\_bus\_init@{spi\_bus\_init}}
\index{spi\_bus\_init@{spi\_bus\_init}!Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}}
\subsubsection{\texorpdfstring{spi\_bus\_init()}{spi\_bus\_init()}}
{\footnotesize\ttfamily int spi\+\_\+bus\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structspi__bus}{spi\+\_\+bus}} $\ast$}]{bus }\end{DoxyParamCaption})}



Initializes a bus control. 

After a sucessful initialization the bus control must be destroyed via \mbox{\hyperlink{group__SPI_ga6d316300e2bb231728d32b5dda355dcd}{spi\+\_\+bus\+\_\+destroy()}}. A registered bus control will be automatically destroyed in case the device file is unlinked. Make sure to call \mbox{\hyperlink{group__SPI_ga6d316300e2bb231728d32b5dda355dcd}{spi\+\_\+bus\+\_\+destroy()}} in a custom destruction handler.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em bus} & The bus control.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & Successful operation. \\
\hline
{\em -\/1} & An error occurred. The errno is set to indicate the error.\\
\hline
\end{DoxyRetVals}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{group__SPI_ga4e6ca0b1d473a6be4fbbefa2ed1a55f2}{spi\+\_\+bus\+\_\+register()}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{group__SPI_ga4e6ca0b1d473a6be4fbbefa2ed1a55f2}\label{group__SPI_ga4e6ca0b1d473a6be4fbbefa2ed1a55f2}} 
\index{Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}!spi\_bus\_register@{spi\_bus\_register}}
\index{spi\_bus\_register@{spi\_bus\_register}!Serial Peripheral Interface (SPI) Driver@{Serial Peripheral Interface (SPI) Driver}}
\subsubsection{\texorpdfstring{spi\_bus\_register()}{spi\_bus\_register()}}
{\footnotesize\ttfamily int spi\+\_\+bus\+\_\+register (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structspi__bus}{spi\+\_\+bus}} $\ast$}]{bus,  }\item[{const char $\ast$}]{bus\+\_\+path }\end{DoxyParamCaption})}



Registers a bus control. 

This function claims ownership of the bus control regardless if the registration is successful or not.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em bus} & The bus control. \\
\hline
\mbox{\texttt{ in}}  & {\em bus\+\_\+path} & The path to the bus device file.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & Successful operation. \\
\hline
{\em -\/1} & An error occurred. The errno is set to indicate the error. \\
\hline
\end{DoxyRetVals}
